<refentry id="gok-main">
<refmeta>
<refentrytitle>main</refentrytitle>
<manvolnum>3</manvolnum>
<refmiscinfo>GOK Library</refmiscinfo>
</refmeta>

<refnamediv>
<refname>main</refname><refpurpose></refpurpose>
</refnamediv>

<refsynopsisdiv><title>Synopsis</title>

<synopsis>



<link linkend="GtkWidget">GtkWidget</link>*  <link linkend="gok-main-create-window">gok_main_create_window</link>          (<link linkend="gboolean">gboolean</link> is_dock);
<link linkend="gboolean">gboolean</link>    <link linkend="gok-main-display-scan">gok_main_display_scan</link>           (<link linkend="GokKeyboard">GokKeyboard</link> *pKeyboard,
                                             <link linkend="gchar">gchar</link> *nameKeyboard,
                                             <link linkend="KeyboardTypes">KeyboardTypes</link> typeKeyboard,
                                             <link linkend="KeyboardLayouts">KeyboardLayouts</link> layout,
                                             <link linkend="KeyboardShape">KeyboardShape</link> shape);
<link linkend="gboolean">gboolean</link>    <link linkend="gok-main-display-scan-previous">gok_main_display_scan_previous</link>  (void);
<link linkend="gboolean">gboolean</link>    <link linkend="gok-main-display-scan-previous-premade">gok_main_display_scan_previous_premade</link>
                                            (void);
<link linkend="gboolean">gboolean</link>    <link linkend="gok-main-display-scan-reset">gok_main_display_scan_reset</link>     (void);
<link linkend="gboolean">gboolean</link>    <link linkend="gok-main-ds">gok_main_ds</link>                     (<link linkend="GokKeyboard">GokKeyboard</link> *pKeyboard);
<link linkend="GokKeyboard">GokKeyboard</link>* <link linkend="gok-main-get-first-keyboard">gok_main_get_first_keyboard</link>    (void);
<link linkend="void">void</link>        <link linkend="gok-main-set-first-keyboard">gok_main_set_first_keyboard</link>     (<link linkend="GokKeyboard">GokKeyboard</link> *pKeyboard);
<link linkend="GokKeyboard">GokKeyboard</link>* <link linkend="gok-main-get-current-keyboard">gok_main_get_current_keyboard</link>  (void);
<link linkend="GtkWidget">GtkWidget</link>*  <link linkend="gok-main-get-main-window">gok_main_get_main_window</link>        (void);
<link linkend="Accessible">Accessible</link>* <link linkend="gok-main-get-foreground-accessible">gok_main_get_foreground_accessible</link>
                                            (void);
<link linkend="void">void</link>        <link linkend="gok-main-resize-window">gok_main_resize_window</link>          (<link linkend="GtkWidget">GtkWidget</link> *pWindow,
                                             <link linkend="GokKeyboard">GokKeyboard</link> *pKeyboard,
                                             <link linkend="gint">gint</link> Width,
                                             <link linkend="gint">gint</link> Height);
<link linkend="void">void</link>        <link linkend="gok-main-store-window-center">gok_main_store_window_center</link>    (void);
<link linkend="Accessible">Accessible</link>* <link linkend="gok-main-get-foreground-window-accessible">gok_main_get_foreground_window_accessible</link>
                                            (void);
<link linkend="void">void</link>        <link linkend="gok-main-read-keyboards">gok_main_read_keyboards</link>         (void);
<link linkend="GokKeyboard">GokKeyboard</link>* <link linkend="gok-main-read-keyboards-from-dir">gok_main_read_keyboards_from_dir</link>
                                            (const <link linkend="char">char</link> *directory,
                                             <link linkend="GokKeyboard">GokKeyboard</link> *first);
<link linkend="void">void</link>        <link linkend="gok-main-on-window-position-change">gok_main_on_window_position_change</link>
                                            (void);
<link linkend="void">void</link>        <link linkend="gok-main-get-our-window-size">gok_main_get_our_window_size</link>    (<link linkend="gint">gint</link> *pWidth,
                                             <link linkend="gint">gint</link> *pHeight);
<link linkend="void">void</link>        <link linkend="gok-main-close">gok_main_close</link>                  (void);
<link linkend="void">void</link>        <link linkend="gok-main-display-error">gok_main_display_error</link>          (<link linkend="gchar">gchar</link> *ErrorString);
<link linkend="void">void</link>        <link linkend="gok-main-display-gconf-error">gok_main_display_gconf_error</link>    (void);
<link linkend="void">void</link>        <link linkend="gok-main-app-change-listener">gok_main_app_change_listener</link>    (<link linkend="Accessible">Accessible</link> *pAccessible);
<link linkend="void">void</link>        <link linkend="gok-main-window-change-listener">gok_main_window_change_listener</link> (<link linkend="Accessible">Accessible</link> *pAccessible);
</synopsis>
</refsynopsisdiv>









<refsect1>
<title>Description</title>
<para>

</para>
</refsect1>

<refsect1>
<title>Details</title>
<refsect2>
<title><anchor id="gok-main-create-window"/>gok_main_create_window ()</title>
<indexterm><primary>gok_main_create_window</primary></indexterm><programlisting><link linkend="GtkWidget">GtkWidget</link>*  gok_main_create_window          (<link linkend="gboolean">gboolean</link> is_dock);</programlisting>
<para>
Creates the window that holds the keyboards.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><parameter>is_dock</parameter>&nbsp;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&nbsp;:</term><listitem><simpara> A pointer to the window, NULL if it couldn't be created.
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-display-scan"/>gok_main_display_scan ()</title>
<indexterm><primary>gok_main_display_scan</primary></indexterm><programlisting><link linkend="gboolean">gboolean</link>    gok_main_display_scan           (<link linkend="GokKeyboard">GokKeyboard</link> *pKeyboard,
                                             <link linkend="gchar">gchar</link> *nameKeyboard,
                                             <link linkend="KeyboardTypes">KeyboardTypes</link> typeKeyboard,
                                             <link linkend="KeyboardLayouts">KeyboardLayouts</link> layout,
                                             <link linkend="KeyboardShape">KeyboardShape</link> shape);</programlisting>
<para>
Display a keyboard and allow the user to make selections from it.
The keyboard must have already been created and in the list of keyboards.
The keyboard is specified by name and keyboard type. A name of NULL means 
the first keyboard in the list. 
The previous keyboard is stored on the "branch back stack".</para>
<para>

</para><variablelist role="params">
<varlistentry><term><parameter>pKeyboard</parameter>&nbsp;:</term>
<listitem><simpara> If this is supplied it takes precedence over the name parameter (useful for dynamic keyboards with the same name)
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>nameKeyboard</parameter>&nbsp;:</term>
<listitem><simpara> Name of the keyboard you want displayed (must be in the list of keyboards.)
# <parameter>typeKeyboard</parameter>: Can be used to describe a runtime keyboard type (e.g. a Menus keyboard)
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>typeKeyboard</parameter>&nbsp;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>layout</parameter>&nbsp;:</term>
<listitem><simpara> Can be used to specify a particular type of keyboard (Example: center-weighted or upper-left-weighted).
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>shape</parameter>&nbsp;:</term>
<listitem><simpara> Can be used to specify a particular shape of keyboard (Example: square).
</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&nbsp;:</term><listitem><simpara> TRUE if keyboard is displayed, FALSE if not.
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-display-scan-previous"/>gok_main_display_scan_previous ()</title>
<indexterm><primary>gok_main_display_scan_previous</primary></indexterm><programlisting><link linkend="gboolean">gboolean</link>    gok_main_display_scan_previous  (void);</programlisting>
<para>
Display and scan the previous keyboard (pulled from the branch-back-stack).
Don't push the current keyboard on the branch-back-stack.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><emphasis>Returns</emphasis>&nbsp;:</term><listitem><simpara> TRUE if the previous keyboard was displayed, FALSE if not.
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-display-scan-previous-premade"/>gok_main_display_scan_previous_premade ()</title>
<indexterm><primary>gok_main_display_scan_previous_premade</primary></indexterm><programlisting><link linkend="gboolean">gboolean</link>    gok_main_display_scan_previous_premade
                                            (void);</programlisting>
<para>
Display and scan the first keyboard pulled from the branch-back-stack
that is premade. Delete any dynamic keyboards that are on the stack 'along
the way'. Don't push the current keyboard on the branch-back-stack.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><emphasis>Returns</emphasis>&nbsp;:</term><listitem><simpara> TRUE if the previous keyboard was displayed, FALSE if not.
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-display-scan-reset"/>gok_main_display_scan_reset ()</title>
<indexterm><primary>gok_main_display_scan_reset</primary></indexterm><programlisting><link linkend="gboolean">gboolean</link>    gok_main_display_scan_reset     (void);</programlisting>
<para>
Display and scan the current keyboard. This should be called after the user settings 
have been changed.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><emphasis>Returns</emphasis>&nbsp;:</term><listitem><simpara> TRUE if the keyboard was displayed, FALSE if not.
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-ds"/>gok_main_ds ()</title>
<indexterm><primary>gok_main_ds</primary></indexterm><programlisting><link linkend="gboolean">gboolean</link>    gok_main_ds                     (<link linkend="GokKeyboard">GokKeyboard</link> *pKeyboard);</programlisting>
<para>
Does the actual work of displaying and scanning the keyboard.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><parameter>pKeyboard</parameter>&nbsp;:</term>
<listitem><simpara> Pointer to the keyboard that will be displayed and scanned.
</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&nbsp;:</term><listitem><simpara> TRUE if the keyboard was displayed, FALSE if not.
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-get-first-keyboard"/>gok_main_get_first_keyboard ()</title>
<indexterm><primary>gok_main_get_first_keyboard</primary></indexterm><programlisting><link linkend="GokKeyboard">GokKeyboard</link>* gok_main_get_first_keyboard    (void);</programlisting>
<para>
Accessor function.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><emphasis>Returns</emphasis>&nbsp;:</term><listitem><simpara> A pointer to the first keyboard in the list of keyboards.
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-set-first-keyboard"/>gok_main_set_first_keyboard ()</title>
<indexterm><primary>gok_main_set_first_keyboard</primary></indexterm><programlisting><link linkend="void">void</link>        gok_main_set_first_keyboard     (<link linkend="GokKeyboard">GokKeyboard</link> *pKeyboard);</programlisting>
<para>
Sets the first keyboard in the list of keyboards.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><parameter>pKeyboard</parameter>&nbsp;:</term>
<listitem><simpara> Pointer to the keyboard that will be set as the first keyboard.
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-get-current-keyboard"/>gok_main_get_current_keyboard ()</title>
<indexterm><primary>gok_main_get_current_keyboard</primary></indexterm><programlisting><link linkend="GokKeyboard">GokKeyboard</link>* gok_main_get_current_keyboard  (void);</programlisting>
<para>
Accessor function.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><emphasis>Returns</emphasis>&nbsp;:</term><listitem><simpara> A pointer to the keyboard that is currently displayed.
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-get-main-window"/>gok_main_get_main_window ()</title>
<indexterm><primary>gok_main_get_main_window</primary></indexterm><programlisting><link linkend="GtkWidget">GtkWidget</link>*  gok_main_get_main_window        (void);</programlisting>
<para>
Accessor function.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><emphasis>Returns</emphasis>&nbsp;:</term><listitem><simpara> A pointer to main GOK window.
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-get-foreground-accessible"/>gok_main_get_foreground_accessible ()</title>
<indexterm><primary>gok_main_get_foreground_accessible</primary></indexterm><programlisting><link linkend="Accessible">Accessible</link>* gok_main_get_foreground_accessible
                                            (void);</programlisting>
<para>

</para><variablelist role="params">
<varlistentry><term><emphasis>Returns</emphasis>&nbsp;:</term><listitem><simpara>


</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-resize-window"/>gok_main_resize_window ()</title>
<indexterm><primary>gok_main_resize_window</primary></indexterm><programlisting><link linkend="void">void</link>        gok_main_resize_window          (<link linkend="GtkWidget">GtkWidget</link> *pWindow,
                                             <link linkend="GokKeyboard">GokKeyboard</link> *pKeyboard,
                                             <link linkend="gint">gint</link> Width,
                                             <link linkend="gint">gint</link> Height);</programlisting>
<para>
Resizes the main window to the given width and height.
The main window is centered over the the center location in gok_data
The new window will not be resized so it appears off screen.
When the new window is resized it generates 2 calls (configure events)to 
gok_main_store_window_center. If the new window is not centered over the old 
window then m_countIgnoreConfigure will be set to 2 so that the window 
center is not changed.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><parameter>pWindow</parameter>&nbsp;:</term>
<listitem><simpara> Pointer to the main window.
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>pKeyboard</parameter>&nbsp;:</term>
<listitem><simpara> Pointer to the relevant (pending) keyboard (may be NULL).
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>Width</parameter>&nbsp;:</term>
<listitem><simpara> Width of the new window.
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>Height</parameter>&nbsp;:</term>
<listitem><simpara> Height of the new window.
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-store-window-center"/>gok_main_store_window_center ()</title>
<indexterm><primary>gok_main_store_window_center</primary></indexterm><programlisting><link linkend="void">void</link>        gok_main_store_window_center    (void);</programlisting>
<para>
Stores in gok_data the center location of the current keyboard.</para>
<para>

</para></refsect2>
<refsect2>
<title><anchor id="gok-main-get-foreground-window-accessible"/>gok_main_get_foreground_window_accessible ()</title>
<indexterm><primary>gok_main_get_foreground_window_accessible</primary></indexterm><programlisting><link linkend="Accessible">Accessible</link>* gok_main_get_foreground_window_accessible
                                            (void);</programlisting>
<para>
Accessor function.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><emphasis>Returns</emphasis>&nbsp;:</term><listitem><simpara> A pointer to foreground window's accessible interface.
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-read-keyboards"/>gok_main_read_keyboards ()</title>
<indexterm><primary>gok_main_read_keyboards</primary></indexterm><programlisting><link linkend="void">void</link>        gok_main_read_keyboards         (void);</programlisting>
<para>
Retrieves the name of the directory containing keyboards from GConf.
Then loads the keyboards in that directory using
gok_main_read_keyboards_from_dir.</para>
<para>

</para></refsect2>
<refsect2>
<title><anchor id="gok-main-read-keyboards-from-dir"/>gok_main_read_keyboards_from_dir ()</title>
<indexterm><primary>gok_main_read_keyboards_from_dir</primary></indexterm><programlisting><link linkend="GokKeyboard">GokKeyboard</link>* gok_main_read_keyboards_from_dir
                                            (const <link linkend="char">char</link> *directory,
                                             <link linkend="GokKeyboard">GokKeyboard</link> *first);</programlisting>
<para>
Reads all the keyboard files from the given directory or a subdirectory that
is a closer match based on user's language if it exists.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><parameter>directory</parameter>&nbsp;:</term>
<listitem><simpara> The name of the keyboard root directory location.
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>first</parameter>&nbsp;:</term>
<listitem><simpara>
</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&nbsp;:</term><listitem><simpara> A pointer to the first keyboard, NULL if no keyboards could be read.
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-on-window-position-change"/>gok_main_on_window_position_change ()</title>
<indexterm><primary>gok_main_on_window_position_change</primary></indexterm><programlisting><link linkend="void">void</link>        gok_main_on_window_position_change
                                            (void);</programlisting>
<para>

</para></refsect2>
<refsect2>
<title><anchor id="gok-main-get-our-window-size"/>gok_main_get_our_window_size ()</title>
<indexterm><primary>gok_main_get_our_window_size</primary></indexterm><programlisting><link linkend="void">void</link>        gok_main_get_our_window_size    (<link linkend="gint">gint</link> *pWidth,
                                             <link linkend="gint">gint</link> *pHeight);</programlisting>
<para>
Retreives the width and height that we last resized the window to.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><parameter>pWidth</parameter>&nbsp;:</term>
<listitem><simpara> Pointer to a variable that will hold the window width.
</simpara></listitem></varlistentry>
<varlistentry><term><parameter>pHeight</parameter>&nbsp;:</term>
<listitem><simpara> Pointer to a variable that will hold the window height.
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-close"/>gok_main_close ()</title>
<indexterm><primary>gok_main_close</primary></indexterm><programlisting><link linkend="void">void</link>        gok_main_close                  (void);</programlisting>
<para>
Delete any keyboards that were created.
This must be called at the end of the program.</para>
<para>

</para></refsect2>
<refsect2>
<title><anchor id="gok-main-display-error"/>gok_main_display_error ()</title>
<indexterm><primary>gok_main_display_error</primary></indexterm><programlisting><link linkend="void">void</link>        gok_main_display_error          (<link linkend="gchar">gchar</link> *ErrorString);</programlisting>
<para>
Displays a fatal error dialog (modal).</para>
<para>

</para><variablelist role="params">
<varlistentry><term><parameter>ErrorString</parameter>&nbsp;:</term>
<listitem><simpara> Fatal error message.
</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-display-gconf-error"/>gok_main_display_gconf_error ()</title>
<indexterm><primary>gok_main_display_gconf_error</primary></indexterm><programlisting><link linkend="void">void</link>        gok_main_display_gconf_error    (void);</programlisting>
<para>
Displays a gconf error message.</para>
<para>

</para></refsect2>
<refsect2>
<title><anchor id="gok-main-app-change-listener"/>gok_main_app_change_listener ()</title>
<indexterm><primary>gok_main_app_change_listener</primary></indexterm><programlisting><link linkend="void">void</link>        gok_main_app_change_listener    (<link linkend="Accessible">Accessible</link> *pAccessible);</programlisting>
<para>

</para><variablelist role="params">
<varlistentry><term><parameter>pAccessible</parameter>&nbsp;:</term>
<listitem><simpara>


</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2>
<title><anchor id="gok-main-window-change-listener"/>gok_main_window_change_listener ()</title>
<indexterm><primary>gok_main_window_change_listener</primary></indexterm><programlisting><link linkend="void">void</link>        gok_main_window_change_listener (<link linkend="Accessible">Accessible</link> *pAccessible);</programlisting>
<para>
This function is called each time the foreground window changes.</para>
<para>

</para><variablelist role="params">
<varlistentry><term><parameter>pAccessible</parameter>&nbsp;:</term>
<listitem><simpara> Pointer to the foreground window's accessible interface.
</simpara></listitem></varlistentry>
</variablelist></refsect2>

</refsect1>




</refentry>
