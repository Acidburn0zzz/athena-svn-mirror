<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>MS OLE2</title><meta name="generator" content="DocBook XSL Stylesheets V1.64.1"><link rel="home" href="index.html" title="GSF Reference Manual"><link rel="up" href="parsers.html" title="Stream Parsers"><link rel="previous" href="gsf-Compression.html" title="Compression"><link rel="next" href="gsf-metadata.html" title="metadata"><link rel="part" href="into.html" title="Part I. GSF Overview"><link rel="part" href="api.html" title="Part II. API Reference"><link rel="chapter" href="io.html" title="Basic Input/Output"><link rel="refentry" href="gsf-Input-from-unstructured-files.html" title="Input from unstructured files"><link rel="refentry" href="gsf-Output-to-unstructured-files.html" title="Output to unstructured files"><link rel="chapter" href="sources.html" title="Stream Sources"><link rel="refentry" href="gsf-Infile-reading-structed-files.html" title="Infile reading structed files"><link rel="refentry" href="gsf-Outfile-writing-structed-files.html" title="Outfile writing structed files"><link rel="refentry" href="gsf-Reading-and-Writing-from-local-files-and-directories.html" title="Reading and Writing from local files and directories"><link rel="refentry" href="gsf-memory.html" title="memory"><link rel="refentry" href="gsf-GIOChannel.html" title="GIOChannel"><link rel="refentry" href="gsf-GnomeVFS.html" title="GnomeVFS"><link rel="refentry" href="gsf-Bononbo.html" title="Bononbo"><link rel="chapter" href="parsers.html" title="Stream Parsers"><link rel="refentry" href="gsf-Text.html" title="Text"><link rel="refentry" href="gsf-XML-and-libxml.html" title="XML and libxml"><link rel="refentry" href="gsf-Zip.html" title="Zip"><link rel="refentry" href="gsf-Compression.html" title="Compression"><link rel="refentry" href="gsf-MS-OLE2.html" title="MS OLE2"><link rel="refentry" href="gsf-metadata.html" title="metadata"><link rel="refentry" href="gsf-Structured-Blobs.html" title="Structured Blobs"><link rel="chapter" href="misc.html" title="Miscellaneous"><link rel="refentry" href="gsf-utils.html" title="utils"><link rel="index" href="ix01.html" title="Index"><link rel="section" href="gsf-MS-OLE2.html#id2541475" title="Object Hierarchy"><link rel="section" href="gsf-MS-OLE2.html#id2541536" title="Description"><link rel="section" href="gsf-MS-OLE2.html#id2541546" title="Details"><meta name="generator" content="GTK-Doc V1.2 (XML mode)"><link rel="stylesheet" href="style.css" type="text/css"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table class="navigation" width="100%" summary="Navigation header" cellpadding="2" cellspacing="2"><tr valign="middle"><td><a accesskey="p" href="gsf-Compression.html"><img src="left.png" width="24" height="24" border="0" alt="Prev"></a></td><td><a accesskey="u" href="parsers.html"><img src="up.png" width="24" height="24" border="0" alt="Up"></a></td><td><a accesskey="h" href="index.html"><img src="home.png" width="24" height="24" border="0" alt="Home"></a></td><th width="100%" align="center">GSF Reference Manual</th><td><a accesskey="n" href="gsf-metadata.html"><img src="right.png" width="24" height="24" border="0" alt="Next"></a></td></tr></table><div class="refentry" lang="en"><a name="gsf-MS-OLE2"></a><div class="titlepage"><div></div><div></div></div><div class="refnamediv"><h2><span class="refentrytitle">MS OLE2</span></h2><p>MS OLE2 &#8212; </p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><a name="GsfInfileMSOle"></a><a name="GsfOutfileMSOle"></a><pre class="synopsis">



struct      <a href="gsf-MS-OLE2.html#GsfInfileMSOle-struct">GsfInfileMSOle</a>;
<a href="gsf-Infile-reading-structed-files.html#GsfInfile">GsfInfile</a>*  <a href="gsf-MS-OLE2.html#gsf-infile-msole-new">gsf_infile_msole_new</a>            (<a href="gsf-Input-from-unstructured-files.html#GsfInput">GsfInput</a> *source,
                                             GError **err);
gboolean    <a href="gsf-MS-OLE2.html#gsf-infile-msole-get-class-id">gsf_infile_msole_get_class_id</a>   (<a href="gsf-MS-OLE2.html#GsfInfileMSOle">GsfInfileMSOle</a> const *ole,
                                             guint8 *res);
struct      <a href="gsf-MS-OLE2.html#GsfOutfileMSOle-struct">GsfOutfileMSOle</a>;
<a href="gsf-Outfile-writing-structed-files.html#GsfOutfile">GsfOutfile</a>* <a href="gsf-MS-OLE2.html#gsf-outfile-msole-new">gsf_outfile_msole_new</a>           (<a href="gsf-Output-to-unstructured-files.html#GsfOutput">GsfOutput</a> *sink);
gboolean    <a href="gsf-MS-OLE2.html#gsf-outfile-msole-set-class-id">gsf_outfile_msole_set_class_id</a>  (<a href="gsf-MS-OLE2.html#GsfOutfileMSOle">GsfOutfileMSOle</a> *ole,
                                             guint8 const *clsid);
gboolean    <a href="gsf-MS-OLE2.html#gsf-msole-metadata-read">gsf_msole_metadata_read</a>         (<a href="gsf-Input-from-unstructured-files.html#GsfInput">GsfInput</a> *in,
                                             GError **err);
gboolean    <a href="gsf-MS-OLE2.html#gsf-msole-metadata-write">gsf_msole_metadata_write</a>        (<a href="gsf-Output-to-unstructured-files.html#GsfOutput">GsfOutput</a> *out,
                                             gboolean doc_not_component,
                                             GError **err);
GIConv      <a href="gsf-MS-OLE2.html#gsf-msole-iconv-open-codepages-for-export">gsf_msole_iconv_open_codepages_for_export</a>
                                            (guint codepage_to,
                                             char const *from);
GIConv      <a href="gsf-MS-OLE2.html#gsf-msole-iconv-open-codepage-for-import">gsf_msole_iconv_open_codepage_for_import</a>
                                            (char const *to,
                                             int codepage);
GIConv      <a href="gsf-MS-OLE2.html#gsf-msole-iconv-open-for-export">gsf_msole_iconv_open_for_export</a> (void);
GIConv      <a href="gsf-MS-OLE2.html#gsf-msole-iconv-open-codepage-for-export">gsf_msole_iconv_open_codepage_for_export</a>
                                            (guint codepage_to);
GIConv      <a href="gsf-MS-OLE2.html#gsf-msole-iconv-open-for-import">gsf_msole_iconv_open_for_import</a> (int codepage);
guint       <a href="gsf-MS-OLE2.html#gsf-msole-iconv-win-codepage">gsf_msole_iconv_win_codepage</a>    (void);
guint       <a href="gsf-MS-OLE2.html#gsf-msole-codepage-to-lid">gsf_msole_codepage_to_lid</a>       (int codepage);
guint       <a href="gsf-MS-OLE2.html#gsf-msole-lid-to-codepage">gsf_msole_lid_to_codepage</a>       (guint lid);
gchar*      <a href="gsf-MS-OLE2.html#gsf-msole-lid-to-codepage-str">gsf_msole_lid_to_codepage_str</a>   (guint lid);
guint       <a href="gsf-MS-OLE2.html#gsf-msole-lid-for-language">gsf_msole_lid_for_language</a>      (char const *lang);
GByteArray* <a href="gsf-MS-OLE2.html#gsf-msole-inflate">gsf_msole_inflate</a>               (<a href="gsf-Input-from-unstructured-files.html#GsfInput">GsfInput</a> *input,
                                             <a href="gsf-utils.html#gsf-off-t">gsf_off_t</a> offset);


#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-START-BAT-CAPS">OLE_HEADER_START_BAT</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-MAJOR-VER-CAPS">OLE_HEADER_MAJOR_VER</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-METABAT-SIZE-CAPS">OLE_HEADER_METABAT_SIZE</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-DIRENT-START-CAPS">OLE_HEADER_DIRENT_START</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-NUM-SBAT-CAPS">OLE_HEADER_NUM_SBAT</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-BB-SHIFT-CAPS">OLE_HEADER_BB_SHIFT</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-NUM-BAT-CAPS">OLE_HEADER_NUM_BAT</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-THRESHOLD-CAPS">OLE_HEADER_THRESHOLD</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-METABAT-BLOCK-CAPS">OLE_HEADER_METABAT_BLOCK</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-SBAT-START-CAPS">OLE_HEADER_SBAT_START</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-SIGNATURE-CAPS">OLE_HEADER_SIGNATURE</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-BYTE-ORDER-CAPS">OLE_HEADER_BYTE_ORDER</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-SB-SHIFT-CAPS">OLE_HEADER_SB_SHIFT</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-NUM-METABAT-CAPS">OLE_HEADER_NUM_METABAT</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-SIZE-CAPS">OLE_HEADER_SIZE</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-CLSID-CAPS">OLE_HEADER_CLSID</a>
#define     <a href="gsf-MS-OLE2.html#OLE-HEADER-MINOR-VER-CAPS">OLE_HEADER_MINOR_VER</a>
#define     <a href="gsf-MS-OLE2.html#OLE-DEFAULT-BB-SHIFT-CAPS">OLE_DEFAULT_BB_SHIFT</a>
#define     <a href="gsf-MS-OLE2.html#OLE-DEFAULT-SB-SHIFT-CAPS">OLE_DEFAULT_SB_SHIFT</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-DETAILS-SIZE-CAPS">DIRENT_DETAILS_SIZE</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-SIZE-CAPS">DIRENT_SIZE</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-NAME-LEN-CAPS">DIRENT_NAME_LEN</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-TYPE-PROPERTY-CAPS">DIRENT_TYPE_PROPERTY</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-TYPE-FILE-CAPS">DIRENT_TYPE_FILE</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-MAGIC-END-CAPS">DIRENT_MAGIC_END</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-TYPE-DIR-CAPS">DIRENT_TYPE_DIR</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-MAX-NAME-SIZE-CAPS">DIRENT_MAX_NAME_SIZE</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-FILE-SIZE-CAPS">DIRENT_FILE_SIZE</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-FIRSTBLOCK-CAPS">DIRENT_FIRSTBLOCK</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-TYPE-INVALID-CAPS">DIRENT_TYPE_INVALID</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-USERFLAGS-CAPS">DIRENT_USERFLAGS</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-COLOUR-CAPS">DIRENT_COLOUR</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-MODIFY-TIME-CAPS">DIRENT_MODIFY_TIME</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-TYPE-LOCKBYTES-CAPS">DIRENT_TYPE_LOCKBYTES</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-CREATE-TIME-CAPS">DIRENT_CREATE_TIME</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-PREV-CAPS">DIRENT_PREV</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-NEXT-CAPS">DIRENT_NEXT</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-CHILD-CAPS">DIRENT_CHILD</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-TYPE-CAPS">DIRENT_TYPE</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-CLSID-CAPS">DIRENT_CLSID</a>
#define     <a href="gsf-MS-OLE2.html#DIRENT-TYPE-ROOTDIR-CAPS">DIRENT_TYPE_ROOTDIR</a>
#define     <a href="gsf-MS-OLE2.html#BAT-MAGIC-METABAT-CAPS">BAT_MAGIC_METABAT</a>
#define     <a href="gsf-MS-OLE2.html#BAT-MAGIC-BAT-CAPS">BAT_MAGIC_BAT</a>
#define     <a href="gsf-MS-OLE2.html#BAT-INDEX-SIZE-CAPS">BAT_INDEX_SIZE</a>
#define     <a href="gsf-MS-OLE2.html#BAT-MAGIC-END-OF-CHAIN-CAPS">BAT_MAGIC_END_OF_CHAIN</a>
#define     <a href="gsf-MS-OLE2.html#BAT-MAGIC-UNUSED-CAPS">BAT_MAGIC_UNUSED</a>
</pre></div><div class="refsect1" lang="en"><a name="id2541475"></a><h2>Object Hierarchy</h2><pre class="synopsis">

  GObject
   +----<a href="gsf-Input-from-unstructured-files.html#GsfInput">GsfInput</a>
         +----<a href="gsf-Infile-reading-structed-files.html#GsfInfile">GsfInfile</a>
               +----GsfInfileMSOle
</pre><pre class="synopsis">

  GObject
   +----<a href="gsf-Output-to-unstructured-files.html#GsfOutput">GsfOutput</a>
         +----<a href="gsf-Outfile-writing-structed-files.html#GsfOutfile">GsfOutfile</a>
               +----GsfOutfileMSOle
</pre></div><div class="refsect1" lang="en"><a name="id2541536"></a><h2>Description</h2><p>

</p></div><div class="refsect1" lang="en"><a name="id2541546"></a><h2>Details</h2><div class="refsect2" lang="en"><a name="id2541551"></a><h3><a name="GsfInfileMSOle-struct"></a>struct GsfInfileMSOle</h3><a class="indexterm" name="id2541562"></a><pre class="programlisting">struct GsfInfileMSOle;</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2541578"></a><h3><a name="gsf-infile-msole-new"></a>gsf_infile_msole_new ()</h3><a class="indexterm" name="id2541589"></a><pre class="programlisting"><a href="gsf-Infile-reading-structed-files.html#GsfInfile">GsfInfile</a>*  gsf_infile_msole_new            (<a href="gsf-Input-from-unstructured-files.html#GsfInput">GsfInput</a> *source,
                                             GError **err);</pre><p>
Opens the root directory of an MS OLE file.
NOTE : adds a reference to <i class="parameter"><tt>source</tt></i></p><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i class="parameter"><tt>source</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><i class="parameter"><tt>err</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>: the new ole file handler
</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2541675"></a><h3><a name="gsf-infile-msole-get-class-id"></a>gsf_infile_msole_get_class_id ()</h3><a class="indexterm" name="id2541687"></a><pre class="programlisting">gboolean    gsf_infile_msole_get_class_id   (<a href="gsf-MS-OLE2.html#GsfInfileMSOle">GsfInfileMSOle</a> const *ole,
                                             guint8 *res);</pre><p>
Retrieves the 16 byte indentifier (often a GUID in MS Windows apps)
stored within the directory associated with <i class="parameter"><tt>ole</tt></i> and stores it in <i class="parameter"><tt>res</tt></i>.</p><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i class="parameter"><tt>ole</tt></i> :</span></td><td> a <a href="gsf-MS-OLE2.html#GsfInfileMSOle"><span class="type">GsfInfileMSOle</span></a>
</td></tr><tr><td><span class="term"><i class="parameter"><tt>res</tt></i> :</span></td><td> 16 byte identifier (often a GUID in MS Windows apps)
</td></tr><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>TRUE on success
</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2541790"></a><h3><a name="GsfOutfileMSOle-struct"></a>struct GsfOutfileMSOle</h3><a class="indexterm" name="id2541802"></a><pre class="programlisting">struct GsfOutfileMSOle;</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2541817"></a><h3><a name="gsf-outfile-msole-new"></a>gsf_outfile_msole_new ()</h3><a class="indexterm" name="id2541829"></a><pre class="programlisting"><a href="gsf-Outfile-writing-structed-files.html#GsfOutfile">GsfOutfile</a>* gsf_outfile_msole_new           (<a href="gsf-Output-to-unstructured-files.html#GsfOutput">GsfOutput</a> *sink);</pre><p>
Creates the root directory of an MS OLE file and manages the addition of
children.
</p><p>
NOTE : adds a reference to <i class="parameter"><tt>sink</tt></i></p><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i class="parameter"><tt>sink</tt></i> :</span></td><td> a <a href="gsf-Output-to-unstructured-files.html#GsfOutput"><span class="type">GsfOutput</span></a> to hold the OLE2 file
</td></tr><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>: the new ole file handler
</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2541906"></a><h3><a name="gsf-outfile-msole-set-class-id"></a>gsf_outfile_msole_set_class_id ()</h3><a class="indexterm" name="id2541919"></a><pre class="programlisting">gboolean    gsf_outfile_msole_set_class_id  (<a href="gsf-MS-OLE2.html#GsfOutfileMSOle">GsfOutfileMSOle</a> *ole,
                                             guint8 const *clsid);</pre><p>
Write <i class="parameter"><tt>clsid</tt></i> to the directory associated with <i class="parameter"><tt>ole</tt></i>.</p><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i class="parameter"><tt>ole</tt></i> :</span></td><td> a <a href="gsf-MS-OLE2.html#GsfOutfileMSOle"><span class="type">GsfOutfileMSOle</span></a>
</td></tr><tr><td><span class="term"><i class="parameter"><tt>clsid</tt></i> :</span></td><td> 16 byte identifier (often a GUID in MS Windows apps)
</td></tr><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>TRUE on success.
</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2542021"></a><h3><a name="gsf-msole-metadata-read"></a>gsf_msole_metadata_read ()</h3><a class="indexterm" name="id2542033"></a><pre class="programlisting">gboolean    gsf_msole_metadata_read         (<a href="gsf-Input-from-unstructured-files.html#GsfInput">GsfInput</a> *in,
                                             GError **err);</pre><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i class="parameter"><tt>in</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><i class="parameter"><tt>err</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>


</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2542109"></a><h3><a name="gsf-msole-metadata-write"></a>gsf_msole_metadata_write ()</h3><a class="indexterm" name="id2542120"></a><pre class="programlisting">gboolean    gsf_msole_metadata_write        (<a href="gsf-Output-to-unstructured-files.html#GsfOutput">GsfOutput</a> *out,
                                             gboolean doc_not_component,
                                             GError **err);</pre><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i class="parameter"><tt>out</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><i class="parameter"><tt>doc_not_component</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><i class="parameter"><tt>err</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>


</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2542219"></a><h3><a name="gsf-msole-iconv-open-codepages-for-export"></a>gsf_msole_iconv_open_codepages_for_export ()</h3><a class="indexterm" name="id2542232"></a><pre class="programlisting">GIConv      gsf_msole_iconv_open_codepages_for_export
                                            (guint codepage_to,
                                             char const *from);</pre><p>
</p><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i class="parameter"><tt>codepage_to</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><i class="parameter"><tt>from</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>an iconv converter to go from utf8 -&gt; to our best guess at a useful
	windows codepage.
</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2542315"></a><h3><a name="gsf-msole-iconv-open-codepage-for-import"></a>gsf_msole_iconv_open_codepage_for_import ()</h3><a class="indexterm" name="id2542328"></a><pre class="programlisting">GIConv      gsf_msole_iconv_open_codepage_for_import
                                            (char const *to,
                                             int codepage);</pre><p>
</p><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i class="parameter"><tt>to</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><i class="parameter"><tt>codepage</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>an iconv converter for <i class="parameter"><tt>codepage</tt></i> -&gt; utf8.
</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2542415"></a><h3><a name="gsf-msole-iconv-open-for-export"></a>gsf_msole_iconv_open_for_export ()</h3><a class="indexterm" name="id2542427"></a><pre class="programlisting">GIConv      gsf_msole_iconv_open_for_export (void);</pre><p>
</p><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>an iconv convert to go from utf8 -&gt; to our best guess at a useful
	windows codepage.
</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2542467"></a><h3><a name="gsf-msole-iconv-open-codepage-for-export"></a>gsf_msole_iconv_open_codepage_for_export ()</h3><a class="indexterm" name="id2542480"></a><pre class="programlisting">GIConv      gsf_msole_iconv_open_codepage_for_export
                                            (guint codepage_to);</pre><p>
</p><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i class="parameter"><tt>codepage_to</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>an iconv converter to go from utf8 -&gt; to our best guess at a useful
	windows codepage.
</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2542542"></a><h3><a name="gsf-msole-iconv-open-for-import"></a>gsf_msole_iconv_open_for_import ()</h3><a class="indexterm" name="id2542553"></a><pre class="programlisting">GIConv      gsf_msole_iconv_open_for_import (int codepage);</pre><p>
</p><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i class="parameter"><tt>codepage</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>an iconv converter for single byte encodings <i class="parameter"><tt>codepage</tt></i> -&gt; utf8.
	Attempt to handle the semantics of a specification for multibyte encodings
	since this is only supposed to be used for single bytes.
</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2542621"></a><h3><a name="gsf-msole-iconv-win-codepage"></a>gsf_msole_iconv_win_codepage ()</h3><a class="indexterm" name="id2542633"></a><pre class="programlisting">guint       gsf_msole_iconv_win_codepage    (void);</pre><p>
</p><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>our best guess at the applicable windows code page based on an
	environment variable or the current locale.
</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2542674"></a><h3><a name="gsf-msole-codepage-to-lid"></a>gsf_msole_codepage_to_lid ()</h3><a class="indexterm" name="id2542686"></a><pre class="programlisting">guint       gsf_msole_codepage_to_lid       (int codepage);</pre><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i class="parameter"><tt>codepage</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>


</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2542741"></a><h3><a name="gsf-msole-lid-to-codepage"></a>gsf_msole_lid_to_codepage ()</h3><a class="indexterm" name="id2542753"></a><pre class="programlisting">guint       gsf_msole_lid_to_codepage       (guint lid);</pre><p>
</p><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i class="parameter"><tt>lid</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>our best guess at the codepage for the given language id
</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2542813"></a><h3><a name="gsf-msole-lid-to-codepage-str"></a>gsf_msole_lid_to_codepage_str ()</h3><a class="indexterm" name="id2542825"></a><pre class="programlisting">gchar*      gsf_msole_lid_to_codepage_str   (guint lid);</pre><p>
</p><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i class="parameter"><tt>lid</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>the Iconv codepage string for the given LID.
Return value must be <tt class="function">g_free()</tt>'d
</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2542896"></a><h3><a name="gsf-msole-lid-for-language"></a>gsf_msole_lid_for_language ()</h3><a class="indexterm" name="id2542908"></a><pre class="programlisting">guint       gsf_msole_lid_for_language      (char const *lang);</pre><p>
</p><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i class="parameter"><tt>lang</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>the LID (Language Identifier) for the input language.
If lang is <tt class="literal">null</tt>, return 0x0400 ("-none-"), and not 0x0000 ("no proofing")
</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2542975"></a><h3><a name="gsf-msole-inflate"></a>gsf_msole_inflate ()</h3><a class="indexterm" name="id2542986"></a><pre class="programlisting">GByteArray* gsf_msole_inflate               (<a href="gsf-Input-from-unstructured-files.html#GsfInput">GsfInput</a> *input,
                                             <a href="gsf-utils.html#gsf-off-t">gsf_off_t</a> offset);</pre><p>
Decompresses an LZ compressed stream.</p><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i class="parameter"><tt>input</tt></i> :</span></td><td> stream to read from
</td></tr><tr><td><span class="term"><i class="parameter"><tt>offset</tt></i> :</span></td><td> offset into it for start byte of compresse stream
</td></tr><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td> A GByteArray that the caller is responsible for freeing
</td></tr></tbody></table></div></div><hr><div class="refsect2" lang="en"><a name="id2543069"></a><h3><a name="OLE-HEADER-START-BAT-CAPS"></a>OLE_HEADER_START_BAT</h3><a class="indexterm" name="id2543081"></a><pre class="programlisting">#define OLE_HEADER_START_BAT	 0x4c
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543096"></a><h3><a name="OLE-HEADER-MAJOR-VER-CAPS"></a>OLE_HEADER_MAJOR_VER</h3><a class="indexterm" name="id2543107"></a><pre class="programlisting">#define OLE_HEADER_MAJOR_VER	 0x1a	/* 0x3 been seen in wild */
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543123"></a><h3><a name="OLE-HEADER-METABAT-SIZE-CAPS"></a>OLE_HEADER_METABAT_SIZE</h3><a class="indexterm" name="id2543136"></a><pre class="programlisting">#define OLE_HEADER_METABAT_SIZE	 ((OLE_HEADER_SIZE - OLE_HEADER_START_BAT) / BAT_INDEX_SIZE)
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543152"></a><h3><a name="OLE-HEADER-DIRENT-START-CAPS"></a>OLE_HEADER_DIRENT_START</h3><a class="indexterm" name="id2543164"></a><pre class="programlisting">#define OLE_HEADER_DIRENT_START  0x30
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543180"></a><h3><a name="OLE-HEADER-NUM-SBAT-CAPS"></a>OLE_HEADER_NUM_SBAT</h3><a class="indexterm" name="id2543191"></a><pre class="programlisting">#define OLE_HEADER_NUM_SBAT      0x40
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543207"></a><h3><a name="OLE-HEADER-BB-SHIFT-CAPS"></a>OLE_HEADER_BB_SHIFT</h3><a class="indexterm" name="id2543218"></a><pre class="programlisting">#define OLE_HEADER_BB_SHIFT      0x1e
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543234"></a><h3><a name="OLE-HEADER-NUM-BAT-CAPS"></a>OLE_HEADER_NUM_BAT</h3><a class="indexterm" name="id2543245"></a><pre class="programlisting">#define OLE_HEADER_NUM_BAT	 0x2c
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543260"></a><h3><a name="OLE-HEADER-THRESHOLD-CAPS"></a>OLE_HEADER_THRESHOLD</h3><a class="indexterm" name="id2543271"></a><pre class="programlisting">#define OLE_HEADER_THRESHOLD	 0x38
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543286"></a><h3><a name="OLE-HEADER-METABAT-BLOCK-CAPS"></a>OLE_HEADER_METABAT_BLOCK</h3><a class="indexterm" name="id2543298"></a><pre class="programlisting">#define OLE_HEADER_METABAT_BLOCK 0x44
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543314"></a><h3><a name="OLE-HEADER-SBAT-START-CAPS"></a>OLE_HEADER_SBAT_START</h3><a class="indexterm" name="id2543325"></a><pre class="programlisting">#define OLE_HEADER_SBAT_START    0x3c
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543341"></a><h3><a name="OLE-HEADER-SIGNATURE-CAPS"></a>OLE_HEADER_SIGNATURE</h3><a class="indexterm" name="id2543352"></a><pre class="programlisting">#define OLE_HEADER_SIGNATURE	 0x00
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543366"></a><h3><a name="OLE-HEADER-BYTE-ORDER-CAPS"></a>OLE_HEADER_BYTE_ORDER</h3><a class="indexterm" name="id2543378"></a><pre class="programlisting">#define OLE_HEADER_BYTE_ORDER	 0x1c	/* 0xfe 0xff == Intel Little Endian */
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543394"></a><h3><a name="OLE-HEADER-SB-SHIFT-CAPS"></a>OLE_HEADER_SB_SHIFT</h3><a class="indexterm" name="id2543406"></a><pre class="programlisting">#define OLE_HEADER_SB_SHIFT      0x20
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543422"></a><h3><a name="OLE-HEADER-NUM-METABAT-CAPS"></a>OLE_HEADER_NUM_METABAT</h3><a class="indexterm" name="id2543433"></a><pre class="programlisting">#define OLE_HEADER_NUM_METABAT   0x48
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543448"></a><h3><a name="OLE-HEADER-SIZE-CAPS"></a>OLE_HEADER_SIZE</h3><a class="indexterm" name="id2543460"></a><pre class="programlisting">#define OLE_HEADER_SIZE		 0x200	/* independent of big block size size */
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543476"></a><h3><a name="OLE-HEADER-CLSID-CAPS"></a>OLE_HEADER_CLSID</h3><a class="indexterm" name="id2543487"></a><pre class="programlisting">#define OLE_HEADER_CLSID	 0x08	/* See ReadClassStg */
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543502"></a><h3><a name="OLE-HEADER-MINOR-VER-CAPS"></a>OLE_HEADER_MINOR_VER</h3><a class="indexterm" name="id2543513"></a><pre class="programlisting">#define OLE_HEADER_MINOR_VER	 0x18	/* 0x33 and 0x3e have been seen */
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543529"></a><h3><a name="OLE-DEFAULT-BB-SHIFT-CAPS"></a>OLE_DEFAULT_BB_SHIFT</h3><a class="indexterm" name="id2543540"></a><pre class="programlisting">#define OLE_DEFAULT_BB_SHIFT	 9
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543556"></a><h3><a name="OLE-DEFAULT-SB-SHIFT-CAPS"></a>OLE_DEFAULT_SB_SHIFT</h3><a class="indexterm" name="id2543567"></a><pre class="programlisting">#define OLE_DEFAULT_SB_SHIFT	 6
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543583"></a><h3><a name="DIRENT-DETAILS-SIZE-CAPS"></a>DIRENT_DETAILS_SIZE</h3><a class="indexterm" name="id2543594"></a><pre class="programlisting">#define DIRENT_DETAILS_SIZE	0x40
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543610"></a><h3><a name="DIRENT-SIZE-CAPS"></a>DIRENT_SIZE</h3><a class="indexterm" name="id2543620"></a><pre class="programlisting">#define DIRENT_SIZE		(DIRENT_MAX_NAME_SIZE + DIRENT_DETAILS_SIZE)
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543635"></a><h3><a name="DIRENT-NAME-LEN-CAPS"></a>DIRENT_NAME_LEN</h3><a class="indexterm" name="id2543647"></a><pre class="programlisting">#define DIRENT_NAME_LEN		0x40	/* length in bytes incl 0 terminator */
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543663"></a><h3><a name="DIRENT-TYPE-PROPERTY-CAPS"></a>DIRENT_TYPE_PROPERTY</h3><a class="indexterm" name="id2543674"></a><pre class="programlisting">#define DIRENT_TYPE_PROPERTY	4	/* ? */
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543689"></a><h3><a name="DIRENT-TYPE-FILE-CAPS"></a>DIRENT_TYPE_FILE</h3><a class="indexterm" name="id2543701"></a><pre class="programlisting">#define DIRENT_TYPE_FILE	2
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543716"></a><h3><a name="DIRENT-MAGIC-END-CAPS"></a>DIRENT_MAGIC_END</h3><a class="indexterm" name="id2543728"></a><pre class="programlisting">#define DIRENT_MAGIC_END	0xffffffff
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543743"></a><h3><a name="DIRENT-TYPE-DIR-CAPS"></a>DIRENT_TYPE_DIR</h3><a class="indexterm" name="id2543755"></a><pre class="programlisting">#define DIRENT_TYPE_DIR		1
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543770"></a><h3><a name="DIRENT-MAX-NAME-SIZE-CAPS"></a>DIRENT_MAX_NAME_SIZE</h3><a class="indexterm" name="id2543781"></a><pre class="programlisting">#define DIRENT_MAX_NAME_SIZE	0x40
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543796"></a><h3><a name="DIRENT-FILE-SIZE-CAPS"></a>DIRENT_FILE_SIZE</h3><a class="indexterm" name="id2543808"></a><pre class="programlisting">#define DIRENT_FILE_SIZE	0x78
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543823"></a><h3><a name="DIRENT-FIRSTBLOCK-CAPS"></a>DIRENT_FIRSTBLOCK</h3><a class="indexterm" name="id2543835"></a><pre class="programlisting">#define DIRENT_FIRSTBLOCK	0x74
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543850"></a><h3><a name="DIRENT-TYPE-INVALID-CAPS"></a>DIRENT_TYPE_INVALID</h3><a class="indexterm" name="id2543861"></a><pre class="programlisting">#define DIRENT_TYPE_INVALID	0
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543876"></a><h3><a name="DIRENT-USERFLAGS-CAPS"></a>DIRENT_USERFLAGS</h3><a class="indexterm" name="id2543887"></a><pre class="programlisting">#define DIRENT_USERFLAGS	0x60	/* only for dirs */
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543903"></a><h3><a name="DIRENT-COLOUR-CAPS"></a>DIRENT_COLOUR</h3><a class="indexterm" name="id2543913"></a><pre class="programlisting">#define DIRENT_COLOUR		0x43
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543928"></a><h3><a name="DIRENT-MODIFY-TIME-CAPS"></a>DIRENT_MODIFY_TIME</h3><a class="indexterm" name="id2543940"></a><pre class="programlisting">#define DIRENT_MODIFY_TIME	0x6c	/* for files */
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543955"></a><h3><a name="DIRENT-TYPE-LOCKBYTES-CAPS"></a>DIRENT_TYPE_LOCKBYTES</h3><a class="indexterm" name="id2543966"></a><pre class="programlisting">#define DIRENT_TYPE_LOCKBYTES	3	/* ? */
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2543982"></a><h3><a name="DIRENT-CREATE-TIME-CAPS"></a>DIRENT_CREATE_TIME</h3><a class="indexterm" name="id2543994"></a><pre class="programlisting">#define DIRENT_CREATE_TIME	0x64	/* for files */
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2544009"></a><h3><a name="DIRENT-PREV-CAPS"></a>DIRENT_PREV</h3><a class="indexterm" name="id2544020"></a><pre class="programlisting">#define DIRENT_PREV		0x44
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2544035"></a><h3><a name="DIRENT-NEXT-CAPS"></a>DIRENT_NEXT</h3><a class="indexterm" name="id2544046"></a><pre class="programlisting">#define DIRENT_NEXT		0x48
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2544061"></a><h3><a name="DIRENT-CHILD-CAPS"></a>DIRENT_CHILD</h3><a class="indexterm" name="id2544072"></a><pre class="programlisting">#define DIRENT_CHILD		0x4c
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2544087"></a><h3><a name="DIRENT-TYPE-CAPS"></a>DIRENT_TYPE</h3><a class="indexterm" name="id2544098"></a><pre class="programlisting">#define DIRENT_TYPE		0x42
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2544113"></a><h3><a name="DIRENT-CLSID-CAPS"></a>DIRENT_CLSID</h3><a class="indexterm" name="id2544124"></a><pre class="programlisting">#define DIRENT_CLSID		0x50	/* only for dirs */
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2544140"></a><h3><a name="DIRENT-TYPE-ROOTDIR-CAPS"></a>DIRENT_TYPE_ROOTDIR</h3><a class="indexterm" name="id2544152"></a><pre class="programlisting">#define DIRENT_TYPE_ROOTDIR	5
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2544167"></a><h3><a name="BAT-MAGIC-METABAT-CAPS"></a>BAT_MAGIC_METABAT</h3><a class="indexterm" name="id2544178"></a><pre class="programlisting">#define BAT_MAGIC_METABAT	0xfffffffc	/* a metabat block -4 */
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2544194"></a><h3><a name="BAT-MAGIC-BAT-CAPS"></a>BAT_MAGIC_BAT</h3><a class="indexterm" name="id2544204"></a><pre class="programlisting">#define BAT_MAGIC_BAT		0xfffffffd	/* a bat block,    -3 */
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2544220"></a><h3><a name="BAT-INDEX-SIZE-CAPS"></a>BAT_INDEX_SIZE</h3><a class="indexterm" name="id2544231"></a><pre class="programlisting">#define BAT_INDEX_SIZE		 4
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2544246"></a><h3><a name="BAT-MAGIC-END-OF-CHAIN-CAPS"></a>BAT_MAGIC_END_OF_CHAIN</h3><a class="indexterm" name="id2544258"></a><pre class="programlisting">#define BAT_MAGIC_END_OF_CHAIN	0xfffffffe	/*		   -2 */
</pre><p>

</p></div><hr><div class="refsect2" lang="en"><a name="id2544274"></a><h3><a name="BAT-MAGIC-UNUSED-CAPS"></a>BAT_MAGIC_UNUSED</h3><a class="indexterm" name="id2544286"></a><pre class="programlisting">#define BAT_MAGIC_UNUSED	0xffffffff	/*		   -1 */
</pre><p>

</p></div></div></div><table class="navigation" width="100%" summary="Navigation footer" cellpadding="2" cellspacing="0"><tr valign="middle"><td align="left"><a accesskey="p" href="gsf-Compression.html"><b>&lt;&lt; Compression</b></a></td><td align="right"><a accesskey="n" href="gsf-metadata.html"><b>metadata &gt;&gt;</b></a></td></tr></table></body></html>
