<head>
<title>UK TeX FAQ -- question 219</title>
</head><body>
<h3>Defining macros within macros</h3>
<p>The way to think of this is that <code>##</code> gets replaced by <code>#</code> in just the
same way that <code>#1</code> gets replaced by 'whatever is the first argument'.
<p>So if you define a macro and use it as:
<pre>
  \def\a#1{+++#1+++#1+++#1+++}  \a{b}
</pre>
the macro expansion produces '+++b+++b+++b+++',
which people find normal.  However, if we now replace part of the macro:
<pre>
  \def\a#1{+++#1+++\def\x #1{xxx#1}}
</pre>
<code>\a{b}</code> will expand to '+++b+++<code>\def\x b{xxxb}</code>'.  This
defines <code>\x</code> to be a macro <em>delimited</em> by <code>b</code>, and taking no
arguments, which people may find strange, even though it is just a
specialisation of the example above.  If you want <code>\a</code> to
define <code>\x</code> to be a macro with one argument, you need to write:
<pre>
  \def\a#1{+++#1+++\def\x ##1{xxx##1}}
</pre>
and <code>\a{b}</code> will expand to 
'+++b+++<code>\def\x #1{xxx#1}</code>', because <code>#1</code> gets replaced by 'b'
and <code>##</code> gets replaced by <code>#</code>.
<p>To nest a definition inside a definition inside a definition then
you need <code>####1</code>, as at each stage <code>##</code> is replaced by
<code>#</code>.  At the next level you need 8 <code>#</code>s each time, and so on.
<p></body>
