# Note that this is NOT a relocatable package
%define nam		@PACKAGE@
%define ver		@VERSION@
%define RELEASE		0_cvs_0
%define rel		%{?CUSTOM_RELEASE}%{!?CUSTOM_RELEASE:%RELEASE}

Summary: 	GPdf the GNOME PDF Viewer
Name: 		%nam
Version: 	%ver
Release: 	%rel
License: 	GPL
Group: 		Application/Network
URL: 		http://www.purl.org/NET/gpdf
Source0: 	%{name}-%{version}.tar.gz
BuildRoot: 	%{_tmppath}/%{name}-%{version}-%{release}-buildroot

Requires:	gtk2		  >= @GTK_REQUIRED@
Requires:	libgnomeui2
Requires:	libbonoboui2
Requires:	libbonobo2 	  >= @LIBBONOBO_REQUIRED@
Requires:	gnome-vfs2
Requires:	libgnomeprint22   >= @LIBGNOMEPRINT_REQUIRED@
Requires:	libgnomeprintui22
Requires:	libglade2
Requires:	gconf2 	          >= @GCONF_REQUIRED@

BuildRequires:	gtk2-devel	  	>= @GTK_REQUIRED@
BuildRequires:	libgnomeui2-devel      	>= @LIBGNOMEUI_REQUIRED@
BuildRequires:	libbonoboui2-devel
BuildRequires:	libbonobo2-devel    	>= @LIBBONOBO_REQUIRED@
BuildRequires:	gnome-vfs2-devel
BuildRequires:	libgnomeprint22-devel  	>= @LIBGNOMEPRINT_REQUIRED@
BuildRequires:	libgnomeprintui22-devel
BuildRequires:	libglade2-devel
BuildRequires:	gconf2-devel   		>= @GCONF_REQUIRED@

%description
GPdf is a PDF viewer for the GNOME 2 platform. It is based on the 
Xpdf by Derek B. Noonburg/Glyph & Cog and the GNOME Print Preview 
widget.
Xpdf is an open source viewer for Portable Document Format (PDF)
files.  (These are also sometimes also called 'Acrobat' files, from
the name of Adobe's PDF software.)  The Xpdf project also includes a
PDF text extractor, PDF-to-PostScript converter, and various other
utilities.

%prep
%setup -q
%configure \
	--disable-maintainer-mode --disable-dependency-tracking \
	--enable-compile-warnings=no --enable-cxx-warnings=no \
	--disable-no-text-select --enable-opi --enable-multithreaded \
	--disable-schemas-install

%build
if [ "$SMP" != "" ]; then
  (make "MAKE=make -k -j $SMP"; exit 0)
  make
else
  make
fi

%install
rm -rf $RPM_BUILD_ROOT
make DESTDIR=$RPM_BUILD_ROOT install

%clean
rm -rf $RPM_BUILD_ROOT

%post
export GCONF_CONFIG_SOURCE=`gconftool-2 --get-default-source`
gconftool-2 --makefile-install-rule %{_sysconfdir}/gconf/schemas/gpdf.schemas > /dev/null 2>&1
if which scrollkeeper-update>/dev/null 2>&1; then scrollkeeper-update; fi

%postun
if which scrollkeeper-update>/dev/null 2>&1; then scrollkeeper-update; fi

%files
%defattr(-,root,root,-)
%doc AUTHORS ChangeLog CHANGES COPYING 
%doc INSTALL NEWS README

%{_prefix}/bin/gpdf

%{_prefix}/libexec/gnome-pdf-viewer

%{_datadir}/gpdf/glade/*.glade

%{_datadir}/pixmaps/gpdf/*.png
%{_datadir}/pixmaps/gnome-pdf.png

%{_datadir}/gnome-2.0/ui/*.xml

%{_datadir}/locale/*/LC_MESSAGES/gpdf.mo

%{_datadir}/gnome/help/gpdf/*/*.xml
%{_datadir}/gnome/help/gpdf/*/figures/*.png

%{_datadir}/omf/gpdf/gpdf-*.omf

%{_datadir}/applications/gpdf.desktop

%{_datadir}/mime-info/gpdf.keys

%{_datadir}/application-registry/gpdf.applications

%{_libdir}/bonobo/servers/GNOME_PDF.server

%{_sysconfdir}/gconf/schemas/gpdf.schemas

%changelog
* Tue Jul  8 2003 Remi Cohen-Scali <rcoscali@cvs.gnome.org> 
- Initial build.


