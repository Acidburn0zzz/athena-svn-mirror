
#
# This makefile is automatically generated by imake... do not modify
# or you may lose your changes when imake generates makefiles again.
# Ignore this message if you are not using imake.
#
#	$Source: /afs/dev.mit.edu/source/repository/third/cns/src/util/makedepend/Makefile,v $
#	$Author: ghudson $
#	$Header: /afs/dev.mit.edu/source/repository/third/cns/src/util/makedepend/Makefile,v 1.1.1.1 1996-09-06 00:48:01 ghudson Exp $
#

NEWTOP=../../.
BUILDTOP=../../.

DEPEND=$(BUILDTOP)/util/makedepend/makedepend

IMAKE=$(BUILDTOP)/util/imake/imake -I$(BUILDTOP)/util/imake.includes

INCLUDE= -I$(BUILDTOP)/include
CFLAGS=$(DBG) $(INCLUDE) $(DEFINES) $(GLOBAL_CDEFS)
LINTFLAGS=$(INCLUDE) $(DEFINES) $(GLOBAL_CDEFS)

#	$Source: /afs/dev.mit.edu/source/repository/third/cns/src/util/makedepend/Makefile,v $
#	$Author: ghudson $
#	$Header: /afs/dev.mit.edu/source/repository/third/cns/src/util/makedepend/Makefile,v 1.1.1.1 1996-09-06 00:48:01 ghudson Exp $
#

GLOBAL_CDEFS= -DATHENA_COMPAT -DATHENA -DKERBEROS -DVFS -DUIDGID_T \
	$(NOENCFLAG) $(DBMFLAG)

SRCTOP=/mit/kerberos/src

DESTDIR=

USRDIR= /usr
SVRDIR= /usr/etc
DAEMDIR= /usr/etc
PROGDIR=/usr/athena
LIBDIR= /usr/athena/lib
USRLIB= /usr/lib
LINTLIBDIR = /usr/lib/lint
BINDIR= /usr/bin
UCBDIR= /usr/ucb
INCLDIR= /usr/include
MANDIR= /usr/man
ETCDIR= /etc
SLASHBINDIR= /bin

KRB_LIB=$(BUILDTOP)/lib/krb/libkrb.a
KRB_LIBDEP=$(KRB_LIB)
KRB_LINTLIB=$(BUILDTOP)/lib/krb/llib-lkrb.ln
KRB_ADM=$(BUILDTOP)/lib/kadm/libkadm.a
KRB_ADMDEP=$(KRB_ADM)
ACL_LIB=$(BUILDTOP)/lib/acl/libacl.a
ACL_LIBDEP=$(ACL_LIB)

NOENCFLAG=
DES_LIB=$(BUILDTOP)/lib/des/libdes.a
DES_LIBDEP=$(DES_LIB)
DES_LINTLIB=$(BUILDTOP)/lib/des/llib-ldes.ln

DBMFLAG=-DNDBM
KDB_LIB=$(BUILDTOP)/lib/kdb/libkdb.a
KDB_LIBDEP=$(KDB_LIB)

COMPILE_ET= $(BUILDTOP)/util/et/compile_et

COM_ERR = $(BUILDTOP)/util/et/libcom_err.a

COM_ERR_DEP = $(COM_ERR)

MAKE_COMMANDS= $(BUILDTOP)/util/ss/make_commands

SS_LIB = $(BUILDTOP)/util/ss/libss.a

SS_LIBDEP = $(SS_LIB)

ARCHIVE= ar cru

RANLIB= ranlib

INSTALLFILE= install -c -m 444

INSTALLLIB= install -c -m 444

INSTALLPROG= install -c -m 555

INSTALLRAW= install

INSTALLSUID= install -c -m 4555 -o root

LD=ld

AS=as

LINT=lint

CC=cc

CCRO=cc -R

HCC=$(CC)

CPP=$(CC) -E

DBG=-O

DEFINES=-DBSD42

HCFLAGS=$(CFLAGS)

TAGGER=etags

MAKE=make
RM=rm -f
MV=mv
CP=cp
LN=ln -s
LPR=lpr -p
CHMOD=chmod

DEF_UID = 113

#	$Source: /afs/dev.mit.edu/source/repository/third/cns/src/util/makedepend/Makefile,v $
#	$Author: ghudson $
#	$Header: /afs/dev.mit.edu/source/repository/third/cns/src/util/makedepend/Makefile,v 1.1.1.1 1996-09-06 00:48:01 ghudson Exp $
#

# $Source: /afs/dev.mit.edu/source/repository/third/cns/src/util/makedepend/Makefile,v $
# $Author: ghudson $
# $Header: /afs/dev.mit.edu/source/repository/third/cns/src/util/makedepend/Makefile,v 1.1.1.1 1996-09-06 00:48:01 ghudson Exp $
#
# Copyright 1987 by the Massachusetts Institute of Technology.
#
# For copying and distribution information,
# please see the file <mit-copyright.h>.
#
# Utility to build makefile header dependancies from C source.
#
# If you have source for cpp...
#

#
# But if you don't have cpp source...
#
SRCS = include.c main.c parse.c pr.c cppsetup.c
SOURCES = \
	${SRCDIR}/util/makedepend/include.c \
	${SRCDIR}/util/makedepend/main.c \
	${SRCDIR}/util/makedepend/parse.c \
	${SRCDIR}/util/makedepend/pr.c \
	${SRCDIR}/util/makedepend/cppsetup.c \
	${SRCDIR}/util/makedepend/def.h \
	${SRCDIR}/util/makedepend/Imakefile \
	${SRCDIR}/util/makedepend/Makefile
OBJS = include.o main.o parse.o pr.o cppsetup.o
DEFINES = '-DINCLUDEDIR="/usr/include"'

CODE=$(SRCS) Imakefile

all:: makedepend

makedepend: $(OBJS)
	$(CC) $(CFLAGS) -o $@ $(OBJS)

clean::
	$(RM) makedepend $(OBJS)

cpy.c: cpy.y yylex.c
	yacc cpy.y
	sed -e '/^# *line/d' < y.tab.c > cpy.c
	$(RM) y.tab.c

cpy.y: $(CPPSRC)/cpy.y
	$(RM) $@
	$(LN) $(CPPSRC)/cpy.y .

yylex.c: $(CPPSRC)/yylex.c
	$(RM) $@
	sed -e 's/#if pdp11 | vax | mc68000/& | ns16000 | ibm032/' \
		$(CPPSRC)/yylex.c > yylex.c

cpp.c: $(CPPSRC)/cpp.c cpp.ed
	$(RM) cpp.c
	/lib/cpp $(CPPSRC)/cpp.c \
		| cb \
		| sed -e '/^$$/d' -e '/^#/d' -e 's/	/ /g' > cpp.c
	sed -e '/^#/d' < cpp.ed | ed - cpp.c

cpp.o: cpp.c
cpy.o: cpy.c

clean::
	$(RM) cpp.c cpy.? yylex.c

config: $(SOURCES)
	-mkdir $(DESTDIR)/util/makedepend
	for i in $(SOURCES); do \
		$(RM) ${DESTDIR}/util/makedepend/`basename $$i`; \
		$(CP) $$i ${DESTDIR}/util/makedepend/`basename $$i`; done

depend:: $(SRCS)
	@echo "### Now computing dependencies"
	@$(DEPEND) -s "# DO NOT DELETE" $(CFLAGS) $(SRCS)

clean::
	$(RM) *~ \#* *.bak $(TAGSFILE)

tags::
	$(TAGGER) *.c *.h

Makefile::
	-$(RM) Makefile.bak; $(MV) Makefile Makefile.bak
	$(IMAKE) -DNEW_TOP=$(NEWTOP) -s Makefile

print:: ${CODE}
	${LPR} ${CODE}

src:: ${CODE}

${CODE}:
	$(RM) $@
	-$(LN) ${SRCDIR}/$@ $@

install::

Makefiles::

# DO NOT DELETE THIS LINE

