#### include configury here
BUILDTOP=$(C)$(S)$(U)$(U)$(U)
      XDMCONFIG = xdm-config
   XDMRESOURCES = Xresources
     XDMSERVERS = Xservers
     XDMSESSION = Xsession

XDMDIR=$(prefix)/lib/X11/xdm

all:: Xservers.ws xdm-config Xservers

#CppFileTarget(Xservers.ws,Xserv.ws.cpp,-DBINDIR=$(BINDIR),NullParameter)
Xservers.ws: Xserv.ws.cpp
	sed -e 's|BINDIR|$(prefix)/bin|g' \
		-e '/^XCOMM/d' \
		< $(srcdir)/Xserv.ws.cpp > Xservers.tmp
	mv -f Xservers.tmp Xservers.ws
#CppFileTarget(xdm-config,xdm-conf.cpp,-DXDMDIR=$(XDMDIR),NullParameter)
xdm-config: xdm-conf.cpp
	sed -e 's|XDMDIR|$(XDMDIR)|g' \
		-e '/^XCOMM/d' \
		< $(srcdir)/xdm-conf.cpp > xdm-conf.tmp
	mv -f xdm-conf.tmp xdm-config

#LinkFile(Xservers,Xservers.XdmServersType)
Xservers: Xservers.ws
	rm -f Xservers
	ln -s Xservers.ws Xservers

##if InstallXdmConfig
#InstallNonExecFile($(XDMCONFIG),$(XDMDIR))
#InstallNonExecFile($(XDMRESOURCES),$(XDMDIR))
#InstallNonExecFile($(XDMSERVERS),$(XDMDIR))
#InstallNamedProg($(XDMSESSION),$(XDMSESSION),$(XDMDIR))
##endif
install::
	$(INSTALLFILE) xdm-config $(DESTDIR)$(XDMDIR)/xdm-config
	$(INSTALLFILE) $(srcdir)/Xresources $(DESTDIR)$(XDMDIR)
	$(INSTALLFILE) Xservers $(DESTDIR)$(XDMDIR)
	$(INSTALLFILE) $(srcdir)/Xaccess $(DESTDIR)$(XDMDIR)
	$(INSTALLPROG) $(srcdir)/Xsession $(DESTDIR)$(XDMDIR)
	$(INSTALLPROG) $(srcdir)/GiveConsole $(DESTDIR)$(XDMDIR)
	$(INSTALLPROG) $(srcdir)/TakeConsole $(DESTDIR)$(XDMDIR)
	$(INSTALLPROG) $(srcdir)/Xsetup_0 $(DESTDIR)$(XDMDIR)

depend::

clean::
	$(RM) Xservers.ws xdm-config Xservers

distclean:: clean
	$(RM) *~ core
	$(RM) Makefile config.status 

