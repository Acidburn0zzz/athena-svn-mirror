
#
# This makefile is automatically generated by imake... do not modify
# or you may lose your changes when imake generates makefiles again.
# Ignore this message if you are not using imake.
#
#	$Source: /afs/dev.mit.edu/source/repository/third/cns/src/lib/krb/Makefile,v $
#	$Author: ghudson $
#	$Header: /afs/dev.mit.edu/source/repository/third/cns/src/lib/krb/Makefile,v 1.1.1.1 1996-09-06 00:47:32 ghudson Exp $
#

NEWTOP=../../.
BUILDTOP=../../.

DEPEND=$(BUILDTOP)/util/makedepend/makedepend

IMAKE=$(BUILDTOP)/util/imake/imake -I$(BUILDTOP)/util/imake.includes

INCLUDE= -I$(BUILDTOP)/include
CFLAGS=$(DBG) $(INCLUDE) $(DEFINES) $(GLOBAL_CDEFS)
LINTFLAGS=$(INCLUDE) $(DEFINES) $(GLOBAL_CDEFS)

#	$Source: /afs/dev.mit.edu/source/repository/third/cns/src/lib/krb/Makefile,v $
#	$Author: ghudson $
#	$Header: /afs/dev.mit.edu/source/repository/third/cns/src/lib/krb/Makefile,v 1.1.1.1 1996-09-06 00:47:32 ghudson Exp $
#

GLOBAL_CDEFS= -DATHENA_COMPAT -DATHENA -DKERBEROS -DVFS $(NOENCFLAG) $(DBMFLAG)

SRCTOP=/mit/kerberos/src

DESTDIR=

SVRDIR= /usr/etc
ATHENADIR=/usr/athena
LIBDIR= /usr/athena/lib
LINTLIBDIR = /usr/lib/lint
BINDIR= /usr/bin
UCBDIR= /usr/ucb
ETCDIR= /etc
DAEMDIR= /usr/etc
SLASHBINDIR= /bin
INCLDIR= /usr/include
MANDIR= /usr/man

KRB_LIB=$(BUILDTOP)/lib/krb/libkrb.a
KRB_LIBDEP=$(KRB_LIB)
KRB_LINTLIB=$(BUILDTOP)/lib/krb/llib-lkrb.ln
KRB_ADM=$(BUILDTOP)/lib/kadm/libkadm.a
KRB_ADMDEP=$(KRB_ADM)

NOENCFLAG=
DES_LIB=$(BUILDTOP)/lib/des/libdes.a
DES_LIBDEP=$(DES_LIB)
DES_LINTLIB=$(BUILDTOP)/lib/des/llib-ldes.ln

DBMFLAG=-DNDBM
KDB_LIB=$(BUILDTOP)/lib/kdb/libkdb.a
KDB_LIBDEP=$(KDB_LIB)

COM_ERR=-lcom_err

COM_ERR_DEP=

ARCHIVE= ar cru

RANLIB= ranlib

COMPILE_ET= compile_et

INSTALLFILE= install -m 444

INSTALLLIB= install -m 444

INSTALLPROG= install -m 555

INSTALLRAW= install

INSTALLSUID= install -m 4555 -o root

LD=ld

AS=as

LINT=lint

CC=cc

CCRO=cc -R

HCC=$(CC)

CPP=$(CC) -E

DBG=-O

DEFINES=-DBSD42

HCFLAGS=$(CFLAGS)

TAGGER=etags

MAKE=make
RM=rm -f
MV=mv
CP=cp
LN=ln -s
LPR=lpr -p
CHMOD=chmod

DEF_UID = 113

#	$Source: /afs/dev.mit.edu/source/repository/third/cns/src/lib/krb/Makefile,v $
#	$Author: ghudson $
#	$Header: /afs/dev.mit.edu/source/repository/third/cns/src/lib/krb/Makefile,v 1.1.1.1 1996-09-06 00:47:32 ghudson Exp $
#

# $Source: /afs/dev.mit.edu/source/repository/third/cns/src/lib/krb/Makefile,v $
# $Author: ghudson $
# $Header: /afs/dev.mit.edu/source/repository/third/cns/src/lib/krb/Makefile,v 1.1.1.1 1996-09-06 00:47:32 ghudson Exp $
#
# Copyright 1987, 1988 by the Massachusetts Institute of Technology.
#
# For copying and distribution information,
# please see the file <mit-copyright.h>.
#
# Imakefile for main Kerberos library.

SRCS = \
	add_ticket.c \
	kntoln.c \
	create_auth_reply.c \
	create_death_packet.c \
	cr_err_reply.c \
	create_ciph.c \
	create_cipher.c \
	create_ticket.c \
	debug_decl.c \
	decomp_ticket.c \
	dest_tkt.c \
	extract_ticket.c \
	fgetst.c \
	getrealm.c \
	get_ad_tkt.c \
	get_cred.c \
	get_in_tkt.c \
	get_krbhst.c \
	get_krbrlm.c \
	get_phost.c \
	get_pw_tkt.c \
	get_request.c \
	get_svc_in_tkt.c \
	getst.c \
	in_tkt.c \
	k_gethostname.c \
	klog.c \
	kname_parse.c \
	kparse.c \
	krb_err_txt.c \
	krb_get_in_tkt.c \
	kuserok.c \
	log.c \
	mk_req.c \
	mk_err.c \
	mk_priv.c \
	mk_safe.c \
	month_sname.c \
	netread.c \
	netwrite.c \
	one.c \
	pkt_cipher.c \
	pkt_clen.c \
	rd_req.c \
	rd_err.c \
	rd_priv.c \
	rd_safe.c \
	read_service_key.c \
	recvauth.c \
	save_credentials.c \
	send_to_kdc.c \
	sendauth.c \
	stime.c \
	tf_util.c \
	tkt_string.c \
	util.c

OBJECTS	= \
	add_ticket.o \
	kntoln.o \
	create_auth_reply.o \
	create_death_packet.o \
	cr_err_reply.o \
	create_ciph.o \
	create_cipher.o \
	create_ticket.o \
	debug_decl.o \
	decomp_ticket.o \
	dest_tkt.o \
	extract_ticket.o \
	fgetst.o \
	getrealm.o \
	get_ad_tkt.o \
	get_cred.o \
	get_in_tkt.o \
	get_krbhst.o \
	get_krbrlm.o \
	get_phost.o \
	get_pw_tkt.o \
	get_request.o \
	get_svc_in_tkt.o \
	getst.o \
	in_tkt.o \
	k_gethostname.o \
	klog.o \
	kname_parse.o \
	kparse.o \
	krb_err_txt.o \
	krb_get_in_tkt.o \
	kuserok.o \
	log.o \
	mk_req.o \
	mk_err.o \
	mk_priv.o \
	mk_safe.o \
	month_sname.o \
	netread.o \
	netwrite.o \
	one.o \
	pkt_cipher.o \
	pkt_clen.o \
	rd_req.o \
	rd_err.o \
	rd_priv.o \
	rd_safe.o \
	read_service_key.o \
	recvauth.o \
	save_credentials.o \
	send_to_kdc.o \
	sendauth.o \
	stime.o \
	tf_util.o \
	tkt_string.o \
	util.o

SRCDIR=$(SRCTOP)/lib/krb
CODE=$(SRCS) Imakefile

# XXX this should be in a configuration header file.
DEFINES=-DBSD42

.c.o:
	$(CC) -p -c $(CFLAGS) $*.c
	-$(LD) -X -r -o profiled/$*.o $*.o
	$(CC) -c $(CFLAGS) $*.c
	-$(LD) -x -r -o a.out $*.o
	$(MV) a.out $*.o

all:: libkrb.a libkrb_p.a
all:: llib-lkrb.ln

libkrb.a: $(OBJECTS)
	$(ARCHIVE) $@ $(OBJECTS)
	$(RANLIB) $@

libkrb_p.a: $(OBJECTS)
	cd profiled; $(ARCHIVE) ../$@ $(OBJECTS)
	$(RANLIB) $@

lint:: llib-lkrb.ln

llib-lkrb.ln: $(SRCS)
	$(LINT) -Ckrb $(LINTFLAGS) $(SRCS) $(DES_LINTLIB)

clean::
	$(RM) libkrb.a libkrb_p.a
	$(RM) llib-lkrb.ln
	$(RM) $(OBJECTS)
	$(RM) profiled/?*.o

install::
	$(INSTALLRAW) -m 644 libkrb.a $(DESTDIR)$(LIBDIR)/libkrb.a
	$(RANLIB) -t $(DESTDIR)$(LIBDIR)/libkrb.a
	$(CHMOD) 444 $(DESTDIR)$(LIBDIR)/libkrb.a
	$(INSTALLRAW) -m 644 libkrb_p.a $(DESTDIR)$(LIBDIR)/libkrb_p.a
	$(RANLIB) -t $(DESTDIR)$(LIBDIR)/libkrb_p.a
	$(CHMOD) 444 $(DESTDIR)$(LIBDIR)/libkrb_p.a
	$(INSTALLFILE) llib-lkrb.ln $(DESTDIR)$(LINTLIBDIR)/llib-lkrb.ln

one.o: one.c
	$(CC) -p -c $(CFLAGS) one.c
	-$(LD) -X -r -o profiled/$*.o $*.o
	$(CCRO) -c $(CFLAGS) one.c
	-$(LD) -x -r -o a.out $*.o
	$(MV) a.out $*.o

krb_err_txt.o: krb_err_txt.c
	$(CC) -p -c $(CFLAGS) krb_err_txt.c
	-$(LD) -X -r -o profiled/$*.o $*.o
	$(CCRO) -c $(CFLAGS) krb_err_txt.c
	-$(LD) -x -r -o a.out $*.o
	$(MV) a.out $*.o

depend:: $(SRCS)
	@echo "### Now computing dependencies"
	@$(DEPEND) -s "# DO NOT DELETE" $(CFLAGS) $(SRCS)

clean::
	$(RM) *~ \#* *.bak $(TAGSFILE)

tags::
	$(TAGGER) *.c *.h

Makefile::
	-$(RM) Makefile.bak; $(MV) Makefile Makefile.bak
	$(IMAKE) -DNEW_TOP=$(NEWTOP) -s Makefile

print:: ${CODE}
	${LPR} ${CODE}

src:: ${CODE}

${CODE}:
	$(RM) $@
	-$(LN) ${SRCDIR}/$@ $@

install::

Makefiles::

# DO NOT DELETE THIS LINE

