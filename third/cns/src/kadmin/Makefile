
#
# This makefile is automatically generated by imake... do not modify
# or you may lose your changes when imake generates makefiles again.
# Ignore this message if you are not using imake.
#
#	$Source: /afs/dev.mit.edu/source/repository/third/cns/src/kadmin/Makefile,v $
#	$Author: ghudson $
#	$Header: /afs/dev.mit.edu/source/repository/third/cns/src/kadmin/Makefile,v 1.1.1.1 1996-09-06 00:47:16 ghudson Exp $
#

NEWTOP=../.
BUILDTOP=../.

DEPEND=$(BUILDTOP)/util/makedepend/makedepend

IMAKE=$(BUILDTOP)/util/imake/imake -I$(BUILDTOP)/util/imake.includes

INCLUDE= -I$(BUILDTOP)/include
CFLAGS=$(DBG) $(INCLUDE) $(DEFINES) $(GLOBAL_CDEFS)
LINTFLAGS=$(INCLUDE) $(DEFINES) $(GLOBAL_CDEFS)

#	$Source: /afs/dev.mit.edu/source/repository/third/cns/src/kadmin/Makefile,v $
#	$Author: ghudson $
#	$Header: /afs/dev.mit.edu/source/repository/third/cns/src/kadmin/Makefile,v 1.1.1.1 1996-09-06 00:47:16 ghudson Exp $
#

GLOBAL_CDEFS= -DATHENA_COMPAT -DATHENA -DKERBEROS -DVFS -DUIDGID_T \
	$(NOENCFLAG) $(DBMFLAG)

SRCTOP=/mit/kerberos/src

DESTDIR=

USRDIR= /usr
SVRDIR= /usr/etc
DAEMDIR= /usr/etc
PROGDIR=/usr/athena
LIBDIR= /usr/athena/lib
USRLIB= /usr/lib
LINTLIBDIR = /usr/lib/lint
BINDIR= /usr/bin
UCBDIR= /usr/ucb
INCLDIR= /usr/include
MANDIR= /usr/man
ETCDIR= /etc
SLASHBINDIR= /bin

KRB_LIB=$(BUILDTOP)/lib/krb/libkrb.a
KRB_LIBDEP=$(KRB_LIB)
KRB_LINTLIB=$(BUILDTOP)/lib/krb/llib-lkrb.ln
KRB_ADM=$(BUILDTOP)/lib/kadm/libkadm.a
KRB_ADMDEP=$(KRB_ADM)
ACL_LIB=$(BUILDTOP)/lib/acl/libacl.a
ACL_LIBDEP=$(ACL_LIB)

NOENCFLAG=
DES_LIB=$(BUILDTOP)/lib/des/libdes.a
DES_LIBDEP=$(DES_LIB)
DES_LINTLIB=$(BUILDTOP)/lib/des/llib-ldes.ln

DBMFLAG=-DNDBM
KDB_LIB=$(BUILDTOP)/lib/kdb/libkdb.a
KDB_LIBDEP=$(KDB_LIB)

COMPILE_ET= $(BUILDTOP)/util/et/compile_et

COM_ERR = $(BUILDTOP)/util/et/libcom_err.a

COM_ERR_DEP = $(COM_ERR)

MAKE_COMMANDS= $(BUILDTOP)/util/ss/make_commands

SS_LIB = $(BUILDTOP)/util/ss/libss.a

SS_LIBDEP = $(SS_LIB)

ARCHIVE= ar cru

RANLIB= ranlib

INSTALLFILE= install -m 444

INSTALLLIB= install -m 444

INSTALLPROG= install -m 555

INSTALLRAW= install

INSTALLSUID= install -m 4555 -o root

LD=ld

AS=as

LINT=lint

CC=cc

CCRO=cc -R

HCC=$(CC)

CPP=$(CC) -E

DBG=-O

DEFINES=-DBSD42

HCFLAGS=$(CFLAGS)

TAGGER=etags

MAKE=make
RM=rm -f
MV=mv
CP=cp
LN=ln -s
LPR=lpr -p
CHMOD=chmod

DEF_UID = 113

#	$Source: /afs/dev.mit.edu/source/repository/third/cns/src/kadmin/Makefile,v $
#	$Author: ghudson $
#	$Header: /afs/dev.mit.edu/source/repository/third/cns/src/kadmin/Makefile,v 1.1.1.1 1996-09-06 00:47:16 ghudson Exp $
#

# $Source: /afs/dev.mit.edu/source/repository/third/cns/src/kadmin/Makefile,v $
# $Author: ghudson $
# $Header: /afs/dev.mit.edu/source/repository/third/cns/src/kadmin/Makefile,v 1.1.1.1 1996-09-06 00:47:16 ghudson Exp $
#
# Copyright 1989 by the Massachusetts Institute of Technology.
#
# For copying and distribution information,
# please see the file <mit-copyright.h>.
#
# Imakefile for Kerberos admin server library.

COMMONSRCS = \
	kadm_supp.c \
	kadm_stream.c

COMMONOBJS	= \
	kadm_supp.o \
	kadm_stream.o \
	kadm_err.o \
	krb_err.o

SSRCS = kadm_server.c kadm_funcs.c admin_server.c kadm_ser_wrap.c
SOBJS = kadm_server.o kadm_funcs.o admin_server.o kadm_ser_wrap.o

CSRCS = kadm_cli_wrap.c
COBJS = kadm_cli_wrap.o

PSRCS = kpasswd.c
POBJS = kpasswd.o

ASRCS = kadmin.c
AOBJS = kadmin.o kadmin_cmds.o

SRCS = $(SSRCS) $(PSRCS) $(ASRCS) $(CSRCS) $(COMMONSRCS)

SRCDIR=$(SRCTOP)/kadmin
CODE=$(SRCS) Imakefile kadm_err.et krb_err.et kadmin_cmds.ct kadm.h
# XXX this should be in a configuration header file.
DEFINES=

all::

kadm_err.h kadm_err.o: kadm_err.et
	$(COMPILE_ET) kadm_err.et
clean::
	$(RM) src.o src.h

depend:: kadm_err.h

krb_err.h krb_err.o: krb_err.et
	$(COMPILE_ET) krb_err.et
clean::
	$(RM) src.o src.h

depend:: krb_err.h

kadmin_cmds.o: kadmin_cmds.ct
	$(MAKE_COMMANDS) kadmin_cmds.ct
clean::
	$(RM) src.o

all:: kpasswd

kpasswd: ${COM_ERR_DEP} ${KRB_LIBDEP} ${DES_LIBDEP}  $(POBJS) $(COBJS) $(COMMONOBJS)
	$(CC) $(CFLAGS) -o $@  $(POBJS) $(COBJS) $(COMMONOBJS)  ${COM_ERR} ${KRB_LIB} ${DES_LIB}

install::
	$(INSTALLPROG) kpasswd ${DESTDIR} ${PROGDIR}/kpasswd

clean::
	$(RM) kpasswd  $(POBJS) $(COBJS) $(COMMONOBJS)

all:: kadmin

kadmin: ${SS_LIBDEP} ${COM_ERR_DEP} ${KRB_LIBDEP} ${DES_LIBDEP}  $(AOBJS) $(COBJS) $(COMMONOBJS)
	$(CC) $(CFLAGS) -o $@  $(AOBJS) $(COBJS) $(COMMONOBJS) ${SS_LIB} ${COM_ERR} ${KRB_LIB} ${DES_LIB}

install::
	$(INSTALLPROG) kadmin ${DESTDIR} ${PROGDIR}/kadmin

clean::
	$(RM) kadmin  $(AOBJS) $(COBJS) $(COMMONOBJS)

all:: kadmind

kadmind: ${COM_ERR_DEP} ${ACL_LIBDEP} ${KDB_LIBDEP} ${KRB_LIBDEP} ${DES_LIBDEP}  $(SOBJS) $(COMMONOBJS)
	$(CC) $(CFLAGS) -o $@  $(SOBJS) $(COMMONOBJS)  ${COM_ERR} ${ACL_LIB} ${KDB_LIB} ${KRB_LIB} ${DES_LIB}

install::
	$(INSTALLPROG) kadmind ${DESTDIR} ${DAEMDIR}/kadmind

clean::
	$(RM) kadmind  $(SOBJS) $(COMMONOBJS)

depend:: ${CODE}

depend:: $(SRCS)
	@echo "### Now computing dependencies"
	@$(DEPEND) -s "# DO NOT DELETE" $(CFLAGS) $(SRCS)

clean::
	$(RM) *~ \#* *.bak $(TAGSFILE)

tags::
	$(TAGGER) *.c *.h

Makefile::
	-$(RM) Makefile.bak; $(MV) Makefile Makefile.bak
	$(IMAKE) -DNEW_TOP=$(NEWTOP) -s Makefile

print:: ${CODE}
	${LPR} ${CODE}

src:: ${CODE}

${CODE}:
	$(RM) $@
	-$(LN) ${SRCDIR}/$@ $@

install::

Makefiles::

# DO NOT DELETE THIS LINE

