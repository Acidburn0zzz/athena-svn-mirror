From prms-admin@cygnus.com  Sun Mar 19 13:32:16 1995
Received: from totalrecall.rs.itd.umich.edu (totalrecall.rs.itd.umich.edu [141.211.144.16]) by cygnus.com (8.6.9/8.6.9) with ESMTP id NAA08801 for <support@cygnus.com>; Sun, 19 Mar 1995 13:32:15 -0800
Received: from enchanter.ifs.umich.edu by totalrecall.rs.itd.umich.edu (8.6.9/2.3)
	with SMTP id QAA19069; Sun, 19 Mar 1995 16:32:14 -0500
Message-Id: <199503192132.QAA19069@totalrecall.rs.itd.umich.edu>
Date: Sun, 19 Mar 1995 16:32:14 -0500
From: michael shiplett <michael.shiplett@umich.edu>
Sender: walrus@umich.edu
To: support@cygnus.com
Subject: cns 95q1 for m68k-next-nextstep3.0

>Number:         6538
>Category:       kerberos
>Synopsis:       cns 95q1 for m68k-next-nextstep3.0
>Confidential:   yes
>Severity:       serious
>Priority:       medium
>Responsible:    eichin
>State:          open
>Class:          sw-bug
>Customer-Id:    net
>Arrival-Date:   Sun Mar 19 13:40:02 1995
>Last-Modified:
>Originator:     
>Organization:
>Release:        
>Environment:
>Description:
>How-To-Repeat:
>Fix:
>Audit-Trail:
Responsible-Changed-From-To: prms-admin->eichin 
Responsible-Changed-By: crash 
Responsible-Changed-When: Sun Mar 19 15:08:17 PST 1995 
Responsible-Changed-Why:  
CNS type stuff. 

>Unformatted:
hello,

below are the diffs I needed to make in order for cns to compile on 
m68k-next-nextstep3.0. I have not built the rdist or x5dm
applications. src/appl/rdist was moved to src/appl/x-rdist to prevent
src/configure.in from trying to configure it.

The programs which I have tested by using are
    src/appl/telnet/telnet/telnet
    src/appl/ftp/ftp/ftp
    src/email/pfrom/pfrom

It may be useful for configure to check for the existence of
unistd.h & #define HAVE_UNISTD.

Thanks for including (working) kerberized ftp & telnet in CNS.

michael

*** /tmp/,RCSt1005289	Sun Mar 19 16:03:56 1995
--- ./src/appl/ftp/ftp/glob.c	Fri Mar 17 16:47:14 1995
***************
*** 41,47 ****
  
  #include <sys/param.h>
  #include <sys/stat.h>
! #include <dirent.h>
  
  #include <pwd.h>
  #include <errno.h>
--- 41,53 ----
  
  #include <sys/param.h>
  #include <sys/stat.h>
! #ifdef NeXT
! #include <sys/dir.h>
! #include <sys/dirent.h>
! #else
! #include <dirent.h>
! #endif
! 
  
  #include <pwd.h>
  #include <errno.h>
*** /tmp/,RCSt1005293	Sun Mar 19 16:03:58 1995
--- ./src/appl/ftp/ftpd/ftpd.c	Sun Mar 19 15:45:34 1995
***************
*** 61,67 ****
--- 61,72 ----
  #include <arpa/telnet.h>
  
  #include <signal.h>
+ #ifdef NeXT
+ #include <sys/dir.h>
+ #include <sys/dirent.h>
+ #else
  #include <dirent.h>
+ #endif /* ! NeXT */
  #include <fcntl.h>
  #include <time.h>
  #include <pwd.h>
***************
*** 69,75 ****
--- 74,82 ----
  #include <netdb.h>
  #include <errno.h>
  #include <syslog.h>
+ #ifndef NeXT
  #include <unistd.h>
+ #endif
  #include <stdio.h>
  #include <ctype.h>
  #include <stdlib.h>
*** /tmp/,RCSt1005297	Sun Mar 19 16:03:59 1995
--- ./src/appl/ftp/ftpd/ftpcmd.y	Sun Mar 19 15:49:19 1995
***************
*** 58,64 ****
--- 58,66 ----
  #include <syslog.h>
  #include <time.h>
  #include <pwd.h>
+ #ifndef NeXT
  #include <unistd.h>
+ #endif
  #include <stdio.h>
  #include <ctype.h>
  #include <stdlib.h>
*** /tmp/,RCSt1005301	Sun Mar 19 16:03:59 1995
--- ./src/appl/telnet/telnetd/defs.h	Fri Mar 17 16:40:06 1995
***************
*** 202,208 ****
  typedef unsigned char cc_t;
  #endif
  
! #ifdef	__STDC__
  #include <unistd.h>
  #endif
  
--- 202,208 ----
  typedef unsigned char cc_t;
  #endif
  
! #if defined(__STDC__) && !defined(NeXT)
  #include <unistd.h>
  #endif
  
*** /tmp/,RCSt1005305	Sun Mar 19 16:04:00 1995
--- ./src/util/ss/error.c	Fri Mar 17 16:11:59 1995
***************
*** 34,39 ****
--- 34,43 ----
  #define STDARG
  #endif
  
+ #ifdef _ANSI_STDARG_H_
+ #define STDARG
+ #endif
+ 
  #ifndef __STDC__
  /* we didn't get it in com_err.h if it wasn't STDC. */
  #ifdef STDARG
*** /tmp/,RCSt1005309	Sun Mar 19 16:04:00 1995
--- ./src/configure.in	Fri Mar 17 16:00:55 1995
***************
*** 116,121 ****
--- 116,122 ----
    hppa1.1-hp-hpux*)	target_makefile_frag=config/mt-snake ;;
    m68k-hp-hpux*)	target_makefile_frag=config/mt-hp300 ;;
    m68k-next-bsd*)	target_makefile_frag=config/mt-next ;;
+   m68k-next-nextstep*)	target_makefile_frag=config/mt-next ;;
    *-*-macos* | *-*-mpw*)	target_makefile_frag=config/mt-mac
  			subdirs="$macsubdirs" ;;
    alpha-dec-osf*)	target_makefile_frag=config/mt-alpha ;;

