<HTML
><HEAD
><TITLE
>gnome-score</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.76b+
"><LINK
REL="HOME"
TITLE="GNOME Library Reference Manual"
HREF="index.html"><LINK
REL="UP"
TITLE="Displaying help and external info"
HREF="x2754.html"><LINK
REL="PREVIOUS"
TITLE="gnome-url"
HREF="libgnome-gnome-url.html"><LINK
REL="NEXT"
TITLE="Miscellaneous"
HREF="x3411.html"><META
NAME="GENERATOR"
CONTENT="GTK-Doc V0.10 (SGML mode)"><STYLE
TYPE="text/css"
>.synopsis, .classsynopsis {
    background: #eeeeee;
    border: solid 1px #aaaaaa;
    padding: 0.5em;
}
.programlisting {
    background: #eeeeff;
    border: solid 1px #aaaaff;
    padding: 0.5em;
}
.variablelist {
    padding: 4px;
    margin-left: 3em;
}
.navigation {
    background: #ffeeee;
    border: solid 1px #ffaaaa;
    margin-top: 0.5em;
    margin-bottom: 0.5em;
}
.navigation a {
    color: #770000;
}
.navigation a:visited {
    color: #550000;
}
.navigation .title {
    font-size: 200%;
}</STYLE
></HEAD
><BODY
CLASS="REFENTRY"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><TABLE
WIDTH="100%"
CLASS="navigation"
SUMMARY="Navigation header"
CELLPADDING="2"
CELLSPACING="2"
><TR
VALIGN="middle"
><TD
><A
ACCESSKEY="p"
HREF="libgnome-gnome-url.html"
><IMG
SRC="left.png"
WIDTH="24"
HEIGHT="24"
BORDER="0"
ALT="Prev"></A
></TD
><TD
><A
ACCESSKEY="u"
HREF="x2754.html"
><IMG
SRC="up.png"
WIDTH="24"
HEIGHT="24"
BORDER="0"
ALT="Up"></A
></TD
><TD
><A
ACCESSKEY="h"
HREF="index.html"
><IMG
SRC="home.png"
WIDTH="24"
HEIGHT="24"
BORDER="0"
ALT="Home"></A
></TD
><TH
WIDTH="100%"
align="center"
>GNOME Library Reference Manual</TH
><TD
><A
ACCESSKEY="n"
HREF="x3411.html"
><IMG
SRC="right.png"
WIDTH="24"
HEIGHT="24"
BORDER="0"
ALT="Next"></A
></TD
></TR
></TABLE
><H1
><A
NAME="LIBGNOME-GNOME-SCORE"
></A
>gnome-score</H1
><DIV
CLASS="REFNAMEDIV"
><A
NAME="AEN3276"
></A
><H2
>Name</H2
>gnome-score&nbsp;--&nbsp;Tracking best scores for games</DIV
><DIV
CLASS="REFSYNOPSISDIV"
><A
NAME="AEN3279"
></A
><H2
>Synopsis</H2
><PRE
CLASS="SYNOPSIS"
>&#13;#include &lt;libgnome/libgnome.h&gt;


gint        <A
HREF="libgnome-gnome-score.html#GNOME-SCORE-INIT"
>gnome_score_init</A
>                (const gchar *gamename);
gint        <A
HREF="libgnome-gnome-score.html#GNOME-SCORE-LOG"
>gnome_score_log</A
>                 (gfloat score,
                                             const gchar *level,
                                             gboolean higher_to_lower_score_order);
gint        <A
HREF="libgnome-gnome-score.html#GNOME-SCORE-GET-NOTABLE"
>gnome_score_get_notable</A
>         (const gchar *gamename,
                                             const gchar *level,
                                             gchar ***names,
                                             gfloat **scores,
                                             time_t **scoretimes);</PRE
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN3297"
></A
><H2
>Description</H2
><P
>The routines in this module provide a simple way to keep track of users' scores
in a game.</P
><P
>In order to acommodate file ownership permissions, the game application should
be installed setgid <I
CLASS="WORDASWORD"
>games</I
> and the scoretable should
only be writable by the <I
CLASS="WORDASWORD"
>games</I
> group. The program
should call <A
HREF="libgnome-gnome-score.html#GNOME-SCORE-INIT"
>gnome_score_init</A
>() as soon as possible inside the main() routine.
This will open a pair of pipes to a child process which can read and write the
score table and then will drop the group privileges of the main program back to
the user's normal group id.</P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN3305"
></A
><H2
>Details</H2
><DIV
CLASS="REFSECT2"
><A
NAME="AEN3307"
></A
><H3
><A
NAME="GNOME-SCORE-INIT"
></A
>gnome_score_init ()</H3
><PRE
CLASS="PROGRAMLISTING"
>gint        gnome_score_init                (const gchar *gamename);</PRE
><P
>GNOME games should call this routine as the first statement
in main() if they have been installed setgid to the "games" group. It
performs the intialization required to later record information in the
scores table and then drops the groups privileges.</P
><P
></P
><P
></P
><TABLE
CLASS="variablelist"
BORDER="0"
CELLSPACING="0"
CELLPADDING="4"
><TBODY
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
><A
NAME="AEN3317"><SPAN
STYLE="white-space: nowrap"
><TT
CLASS="PARAMETER"
><I
>gamename</I
></TT
>&nbsp;:</SPAN
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
> Identifies the game name.</P
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
><A
NAME="AEN3322"><SPAN
STYLE="white-space: nowrap"
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Returns</I
></SPAN
> :</SPAN
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
> <TT
CLASS="LITERAL"
>0</TT
> on success, returns <TT
CLASS="LITERAL"
>-1</TT
> on failure.</P
></TD
></TR
></TBODY
></TABLE
></DIV
><HR><DIV
CLASS="REFSECT2"
><A
NAME="AEN3329"
></A
><H3
><A
NAME="GNOME-SCORE-LOG"
></A
>gnome_score_log ()</H3
><PRE
CLASS="PROGRAMLISTING"
>gint        gnome_score_log                 (gfloat score,
                                             const gchar *level,
                                             gboolean higher_to_lower_score_order);</PRE
><P
>Logs a score entry for the user. You should call this every time a game
ends.  This function takes care of working out whether the user's score made
it into the ten best scores and, if so, records it in the table.</P
><P
></P
><P
></P
><TABLE
CLASS="variablelist"
BORDER="0"
CELLSPACING="0"
CELLPADDING="4"
><TBODY
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
><A
NAME="AEN3340"><SPAN
STYLE="white-space: nowrap"
><TT
CLASS="PARAMETER"
><I
>score</I
></TT
>&nbsp;:</SPAN
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
> The score achieved by the user in this game</P
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
><A
NAME="AEN3345"><SPAN
STYLE="white-space: nowrap"
><TT
CLASS="PARAMETER"
><I
>level</I
></TT
>&nbsp;:</SPAN
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
> The level on which the score was obtained</P
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
><A
NAME="AEN3350"><SPAN
STYLE="white-space: nowrap"
><TT
CLASS="PARAMETER"
><I
>higher_to_lower_score_order</I
></TT
>&nbsp;:</SPAN
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
> Set to <TT
CLASS="LITERAL"
>TRUE</TT
> if high scores are better than
low scores.</P
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
><A
NAME="AEN3356"><SPAN
STYLE="white-space: nowrap"
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Returns</I
></SPAN
> :</SPAN
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
> <TT
CLASS="LITERAL"
>0</TT
> on failure or the status from the gnome-score helper
program.</P
></TD
></TR
></TBODY
></TABLE
></DIV
><HR><DIV
CLASS="REFSECT2"
><A
NAME="AEN3362"
></A
><H3
><A
NAME="GNOME-SCORE-GET-NOTABLE"
></A
>gnome_score_get_notable ()</H3
><PRE
CLASS="PROGRAMLISTING"
>gint        gnome_score_get_notable         (const gchar *gamename,
                                             const gchar *level,
                                             gchar ***names,
                                             gfloat **scores,
                                             time_t **scoretimes);</PRE
><P
>Fetches the most notable players on <TT
CLASS="PARAMETER"
><I
>gamename</I
></TT
> at level <TT
CLASS="PARAMETER"
><I
>level</I
></TT
>.</P
><P
></P
><P
></P
><TABLE
CLASS="variablelist"
BORDER="0"
CELLSPACING="0"
CELLPADDING="4"
><TBODY
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
><A
NAME="AEN3377"><SPAN
STYLE="white-space: nowrap"
><TT
CLASS="PARAMETER"
><I
>gamename</I
></TT
>&nbsp;:</SPAN
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>   The name of the game we want to fetch information from.</P
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
><A
NAME="AEN3382"><SPAN
STYLE="white-space: nowrap"
><TT
CLASS="PARAMETER"
><I
>level</I
></TT
>&nbsp;:</SPAN
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>      The level for which we want to pull information.</P
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
><A
NAME="AEN3387"><SPAN
STYLE="white-space: nowrap"
><TT
CLASS="PARAMETER"
><I
>names</I
></TT
>&nbsp;:</SPAN
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>      An array of strings is returned at the address pointed here</P
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
><A
NAME="AEN3392"><SPAN
STYLE="white-space: nowrap"
><TT
CLASS="PARAMETER"
><I
>scores</I
></TT
>&nbsp;:</SPAN
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>     An array of gfloats is returned at the address pointed here</P
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
><A
NAME="AEN3397"><SPAN
STYLE="white-space: nowrap"
><TT
CLASS="PARAMETER"
><I
>scoretimes</I
></TT
>&nbsp;:</SPAN
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
> An array of time_t is returned at the address pointed here</P
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
><A
NAME="AEN3402"><SPAN
STYLE="white-space: nowrap"
><SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>Returns</I
></SPAN
> :</SPAN
></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
> The number of scores returned.  The <TT
CLASS="PARAMETER"
><I
>names</I
></TT
>, <TT
CLASS="PARAMETER"
><I
>scores</I
></TT
> and <TT
CLASS="PARAMETER"
><I
>scoretime</I
></TT
>
pointers point to regions that were allocated with g_malloc() with the
contents.</P
></TD
></TR
></TBODY
></TABLE
></DIV
></DIV
><TABLE
CLASS="navigation"
WIDTH="100%"
SUMMARY="Navigation footer"
CELLPADDING="2"
CELLSPACING="2"
><TR
VALIGN="middle"
><TD
ALIGN="left"
><A
ACCESSKEY="p"
HREF="libgnome-gnome-url.html"
><B
>&lt;&lt;&lt;&nbsp;gnome-url</B
></A
></TD
><TD
ALIGN="right"
><A
ACCESSKEY="n"
HREF="x3411.html"
><B
>Miscellaneous&nbsp;&gt;&gt;&gt;</B
></A
></TD
></TR
></TABLE
></BODY
></HTML
>