<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>BonoboXObject</title><meta name="generator" content="DocBook XSL Stylesheets V1.59.1"><meta xmlns="http://www.w3.org/TR/xhtml1/transitional" name="generator" content="GTK-Doc V0.10 (XML mode)"></meta><style xmlns="http://www.w3.org/TR/xhtml1/transitional" type="text/css">
        .synopsis, .classsynopsis {
            background: #eeeeee;
            border: solid 1px #aaaaaa;
            padding: 0.5em;
        }
        .programlisting {
            background: #eeeeff;
            border: solid 1px #aaaaff;
            padding: 0.5em;
        }
        .variablelist {
            padding: 4px;
            margin-left: 3em;
        }
        .navigation {
            background: #ffeeee;
            border: solid 1px #ffaaaa;
            margin-top: 0.5em;
            margin-bottom: 0.5em;
        }
        .navigation a {
            color: #770000;
        }
        .navigation a:visited {
            color: #550000;
        }
        .navigation .title {
            font-size: 200%;
        }
      </style><link rel="home" href="index.html" title="Libbonobo Reference Manual"><link rel="up" href="factories.html" title="Objects, Factories, Reference Counting"><link rel="previous" href="libbonobo-bonobo-object.html" title="BonoboObject"><link rel="next" href="libbonobo-bonobo-generic-factory.html" title="BonoboGenericFactory"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navigation" width="100%" summary="Navigation header" cellpadding="2" cellspacing="2"><tr valign="middle"><td><a accesskey="p" href="libbonobo-bonobo-object.html"><img src="left.png" width="24" height="24" border="0" alt="Prev"></img></a></td><td><a accesskey="u" href="factories.html"><img src="up.png" width="24" height="24" border="0" alt="Up"></img></a></td><td><a accesskey="h" href="index.html"><img src="home.png" width="24" height="24" border="0" alt="Home"></img></a></td><th width="100%" align="center">Libbonobo Reference Manual</th><td><a accesskey="n" href="libbonobo-bonobo-generic-factory.html"><img src="right.png" width="24" height="24" border="0" alt="Next"></img></a></td></tr></table><div class="refentry" lang="en"><a name="libbonobo-bonobo-xobject"></a><div class="titlepage"></div><div class="refnamediv"><h2>BonoboXObject</h2><p>BonoboXObject &#8212; a simplified CORBA server object wrapper</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><pre class="synopsis">



#define     <a href="libbonobo-bonobo-xobject.html#BONOBO-X-OBJECT-TYPE-CAPS">BONOBO_X_OBJECT_TYPE</a>
#define     <a href="libbonobo-bonobo-xobject.html#BONOBO-X-OBJECT-HEADER-SIZE-CAPS">BONOBO_X_OBJECT_HEADER_SIZE</a>
#define     <a href="libbonobo-bonobo-xobject.html#BONOBO-X-OBJECT-GET-SERVANT-CAPS">BONOBO_X_OBJECT_GET_SERVANT</a>     (o)
#define     <a href="libbonobo-bonobo-xobject.html#BONOBO-X-SERVANT-GET-OBJECT-CAPS">BONOBO_X_SERVANT_GET_OBJECT</a>     (o)
#define     <a href="libbonobo-bonobo-xobject.html#BonoboXObject">BonoboXObject</a>
#define     <a href="libbonobo-bonobo-xobject.html#BonoboXObjectClass">BonoboXObjectClass</a>
#define     <a href="libbonobo-bonobo-xobject.html#bonobo-x-object">bonobo_x_object</a>
#define     <a href="libbonobo-bonobo-xobject.html#BonoboXObjectPOAFn">BonoboXObjectPOAFn</a>
#define     <a href="libbonobo-bonobo-xobject.html#bonobo-x-type-unique">bonobo_x_type_unique</a>
#define     <a href="libbonobo-bonobo-xobject.html#bonobo-x-type-setup">bonobo_x_type_setup</a>
#define     <a href="libbonobo-bonobo-xobject.html#BONOBO-X-TYPE-FUNC-FULL-CAPS">BONOBO_X_TYPE_FUNC_FULL</a>         (class_name, corba_name, parent, prefix)
#define     <a href="libbonobo-bonobo-xobject.html#BONOBO-X-TYPE-FUNC-CAPS">BONOBO_X_TYPE_FUNC</a>              (class_name, parent, prefix)

</pre></div><div xmlns:ns4="" class="refsect1" lang="en"><h2>Description</h2><p>
BonoboXObject provides an easy to use way of writing CORBA servers. However,
for libbonobo-2.0, all its functionality has been merged with
<a href="libbonobo-bonobo-object.html#BonoboObject">BonoboObject</a>, which is the one that should be used for writing
Bonobo/CORBA servers.
</p><ns4:p>
The CORBA methods are associated with a GObject class in the same
way that standard GObject methods and signals are. We insert the
CORBA generated Entry Point Vector (epv) struct as the first
element of the derived class eg.
  </ns4:p><div class="example"><a name="id2899958"></a><p class="title"><b>Example 1. Setting up the GObjectClass data</b></p><pre class="programlisting">
typedef struct {
	BonoboXObject base;

	BonoboControlPrivate *priv;
} BonoboControl;

typedef struct {
	BonoboXObjectClass      parent_class;

	POA_Bonobo_Control__epv epv;

	/* Signals. */
	void (*set_frame)      (BonoboControl *control);
	void (*activate)       (BonoboControl *control, gboolean state);
} BonoboControlClass;
     </pre></div><ns4:p>
</ns4:p><ns4:p>
Then we set up the type using the <tt>bonobo_x_type_unique</tt>
function instead of gtk_type_unique ( but otherwise in the standard GObject
fashion ).
  </ns4:p><div class="example"><a name="id2898577"></a><p class="title"><b>Example 2. Registering the type with bonobo</b></p><pre class="programlisting">
GType
bonobo_control_get_type (void)
{
	GType ptype;
	static GType type = 0;

	if (type == 0) {
		static GTypeInfo info = {
			&quot;BonoboControl&quot;,
			NULL, NULL,
			sizeof (BonoboControlClass),
			(GClassInitFunc)bonobo_control_class_init,
			NULL, NULL, 
			sizeof (BonoboControl), 0,
			(GObjectInitFunc)bonobo_control_init,
			NULL
		};
		ptype = (parent);
		type = bonobo_x_type_unique (ptype,
			POA_Bonobo_Control__init, NULL,
			G_STRUCT_OFFSET (BonoboControlClass, epv),
			&amp;info, &quot;BonoboControl&quot;);
	}
	return type;
}
     </pre></div><ns4:p>
  Alternatively one can use the simpler BONOBO_X_TYPE_FUNC_FULL
macros to achieve the same thing thus:
  </ns4:p><div class="example"><a name="id2898604"></a><p class="title"><b>Example 3. Registering the type more simply</b></p><pre class="programlisting">
BONOBO_X_TYPE_FUNC_FULL (BonoboControl, Bonobo_Control,
                         PARENT_TYPE, bonobo_control);
     </pre></div><ns4:p>

  The POA_Bonobo_Control__init function is used to construct the CORBA object
and the G_STRUCT_OFFSET tells Bonobo where your epv structure is
in the Class data, so it can build your epv for you.
  The fini_fn function is not used in ORBit, so it is faster to use NULL here.
</ns4:p><ns4:p>
After registering the type in the class initialization function, we
must fill out the epv with our entry points, similar to the way we
hook up virtual class functions. It may also be necessary to override
the parent's epv's; this can be done by accessing the epv pointer for
the parent class.
  </ns4:p><div class="example"><a name="id2898637"></a><p class="title"><b>Example 4. Setting up the class' methods</b></p><pre class="programlisting">
static void
bonobo_control_class_init (BonoboControlClass *klass)
{
	GObjectClass *object_class = (GObjectClass *)klass;
	POA_Bonobo_Control__epv *epv = &amp;klass-&gt;epv;

	bonobo_control_parent_class = g_type_class_peek (PARENT_TYPE);

	...

	object_class-&gt;finalize = bonobo_control_finalize;

	epv-&gt;activate       = impl_Bonobo_Control_activate;
	epv-&gt;setSize        = impl_Bonobo_Control_setSize;
	...
	epv-&gt;realize        = impl_Bonobo_Control_realize;
	epv-&gt;unrealize      = impl_Bonobo_Control_unrealize;
}
     </pre></div><ns4:p>
</ns4:p></div><div class="refsect1" lang="en"><h2>Details</h2><div class="refsect2" lang="en"><h3><a name="BONOBO-X-OBJECT-TYPE-CAPS"></a>BONOBO_X_OBJECT_TYPE</h3><pre class="programlisting">#define BONOBO_X_OBJECT_TYPE        BONOBO_TYPE_X_OBJECT /* deprecated, you should use BONOBO_TYPE_X_OBJECT */
</pre><p>

</p></div><hr xmlns="http://www.w3.org/TR/xhtml1/transitional"></hr><div class="refsect2" lang="en"><h3><a name="BONOBO-X-OBJECT-HEADER-SIZE-CAPS"></a>BONOBO_X_OBJECT_HEADER_SIZE</h3><pre class="programlisting">#define BONOBO_X_OBJECT_HEADER_SIZE BONOBO_OBJECT_HEADER_SIZE
</pre><p>

</p></div><hr xmlns="http://www.w3.org/TR/xhtml1/transitional"></hr><div class="refsect2" lang="en"><h3><a name="BONOBO-X-OBJECT-GET-SERVANT-CAPS"></a>BONOBO_X_OBJECT_GET_SERVANT()</h3><pre class="programlisting">#define BONOBO_X_OBJECT_GET_SERVANT(o) ((PortableServer_Servant)&amp;(o)-&gt;servant)
</pre><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i><tt>o</tt></i> :</span></td><td>


</td></tr></tbody></table></div></div><hr xmlns="http://www.w3.org/TR/xhtml1/transitional"></hr><div class="refsect2" lang="en"><h3><a name="BONOBO-X-SERVANT-GET-OBJECT-CAPS"></a>BONOBO_X_SERVANT_GET_OBJECT()</h3><pre class="programlisting">#define     BONOBO_X_SERVANT_GET_OBJECT(o)</pre><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i><tt>o</tt></i> :</span></td><td>


</td></tr></tbody></table></div></div><hr xmlns="http://www.w3.org/TR/xhtml1/transitional"></hr><div class="refsect2" lang="en"><h3><a name="BonoboXObject"></a>BonoboXObject</h3><pre class="programlisting">#define BonoboXObject            BonoboObject
</pre><p>

</p></div><hr xmlns="http://www.w3.org/TR/xhtml1/transitional"></hr><div class="refsect2" lang="en"><h3><a name="BonoboXObjectClass"></a>BonoboXObjectClass</h3><pre class="programlisting">#define BonoboXObjectClass       BonoboObjectClass
</pre><p>

</p></div><hr xmlns="http://www.w3.org/TR/xhtml1/transitional"></hr><div class="refsect2" lang="en"><h3><a name="bonobo-x-object"></a>bonobo_x_object</h3><pre class="programlisting">#define bonobo_x_object          bonobo_object
</pre><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>
</td></tr></tbody></table></div></div><hr xmlns="http://www.w3.org/TR/xhtml1/transitional"></hr><div class="refsect2" lang="en"><h3><a name="BonoboXObjectPOAFn"></a>BonoboXObjectPOAFn</h3><pre class="programlisting">#define BonoboXObjectPOAFn       BonoboObjectPOAFn
</pre><p>

</p></div><hr xmlns="http://www.w3.org/TR/xhtml1/transitional"></hr><div class="refsect2" lang="en"><h3><a name="bonobo-x-type-unique"></a>bonobo_x_type_unique</h3><pre class="programlisting">#define bonobo_x_type_unique     bonobo_type_unique
</pre><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>
</td></tr></tbody></table></div></div><hr xmlns="http://www.w3.org/TR/xhtml1/transitional"></hr><div class="refsect2" lang="en"><h3><a name="bonobo-x-type-setup"></a>bonobo_x_type_setup</h3><pre class="programlisting">#define bonobo_x_type_setup      bonobo_type_setup
</pre><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></td><td>
</td></tr></tbody></table></div></div><hr xmlns="http://www.w3.org/TR/xhtml1/transitional"></hr><div class="refsect2" lang="en"><h3><a name="BONOBO-X-TYPE-FUNC-FULL-CAPS"></a>BONOBO_X_TYPE_FUNC_FULL()</h3><pre class="programlisting">#define     BONOBO_X_TYPE_FUNC_FULL(class_name, corba_name, parent, prefix)</pre><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i><tt>class_name</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><i><tt>corba_name</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><i><tt>parent</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><i><tt>prefix</tt></i> :</span></td><td>


</td></tr></tbody></table></div></div><hr xmlns="http://www.w3.org/TR/xhtml1/transitional"></hr><div class="refsect2" lang="en"><h3><a name="BONOBO-X-TYPE-FUNC-CAPS"></a>BONOBO_X_TYPE_FUNC()</h3><pre class="programlisting">#define     BONOBO_X_TYPE_FUNC(class_name, parent, prefix)</pre><p>

</p><div class="variablelist"><table border="0"><col align="left" valign="top"><tbody><tr><td><span class="term"><i><tt>class_name</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><i><tt>parent</tt></i> :</span></td><td>
</td></tr><tr><td><span class="term"><i><tt>prefix</tt></i> :</span></td><td>


</td></tr></tbody></table></div></div></div><div class="refsect1" lang="en"><h2>See Also</h2><p>
<a href="libbonobo-bonobo-object.html#BonoboObject">BonoboObject</a>
</p></div></div><table xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navigation" width="100%" summary="Navigation footer" cellpadding="2" cellspacing="0"><tr valign="middle"><td align="left"><a accesskey="p" href="libbonobo-bonobo-object.html"><b>&lt;&lt; BonoboObject</b></a></td><td align="right"><a accesskey="n" href="libbonobo-bonobo-generic-factory.html"><b>BonoboGenericFactory &gt;&gt;</b></a></td></tr></table></body></html>
