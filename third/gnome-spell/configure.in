dnl
dnl Initialization
dnl

AC_INIT(gnome-spell)
AM_CONFIG_HEADER(config.h)

PACKAGE=gnome-spell

dnl
dnl Versions
dnl

GETTEXT_PACKAGE=gnome-spell-1.0.5
GNOME_SPELL_RELEASE=1.0.5
API_VERSION=0.3

dnl
dnl
dnl

AC_SUBST(GNOME_SPELL_RELEASE)
AC_DEFINE_UNQUOTED(GNOME_SPELL_RELEASE, "${GNOME_SPELL_RELEASE}", "GnomeSpell Release")

AM_INIT_AUTOMAKE(gnome-spell, ${GNOME_SPELL_RELEASE})

AM_MAINTAINER_MODE
AC_PROG_INTLTOOL
GNOME_COMPILE_WARNINGS

AC_ISC_POSIX
AC_PROG_CC
AC_PROG_CXX
AC_STDC_HEADERS
AM_PROG_LIBTOOL

# Internationalization support
ALL_LINGUAS="am az be bg cs da de el es fi fr he hu it ja kn lt lv nl no pl pt pt_BR ru sk sr sr@Latn sv ta tr uk wa vi zh_CN"
AM_GLIB_GNU_GETTEXT

AC_SUBST(GETTEXT_PACKAGE)
AC_DEFINE_UNQUOTED(GETTEXT_PACKAGE,"$GETTEXT_PACKAGE","Gettext Package")


AC_DEFINE_UNQUOTED(API_VERSION, "${API_VERSION}", "API Version")
AC_SUBST(API_VERSION)

dnl
dnl aspell
dnl

AC_ARG_WITH(aspell-prefix, [  --with-aspell-prefix=DIR
                          specify under which prefix aspell is installed.], with_aspell_prefix="$withval", )

if test "x$with_aspell_prefix" != "x"; then
   saved_LDFLAGS=$LDFLAGS
   LDFLAGS="-L$with_aspell_prefix/lib "$LDFLAGS
   ASPELL_INC="-I$with_aspell_prefix/include"
   ASPELL_LIBS="-L$with_aspell_prefix/lib -laspell"
   ASPELL_DATA="$with_aspell_prefix/lib/aspell"
else
   LDFLAGS="-L`aspell config prefix`/lib "$LDFLAGS
   ASPELL_INC="-I`aspell config prefix`/include"
   ASPELL_LIBS="-L`aspell config prefix`/lib -laspell"
   ASPELL_DICT="`aspell config dict-dir`"
fi
AC_CHECK_LIB(aspell,new_aspell_config,,AC_MSG_ERROR([gnome-spell cannot be built without aspell library]),)
if test "x$with_aspell_prefix" != "x"; then
   LDFLAGS=$saved_LDFLAGS
fi

AC_SUBST(ASPELL_DICT)
AC_SUBST(ASPELL_INC)
AC_SUBST(ASPELL_LIBS)

dnl
dnl flags
dnl


AC_SUBST(CFLAGS)
AC_SUBST(CPPFLAGS)
AC_SUBST(LDFLAGS)

GNOME_SPELL_MODULES="libgnomeui-2.0 >= 1.112.1 libbonoboui-2.0 >= 1.112.1 libglade-2.0 >= 1.99.9"
PKG_CHECK_MODULES(GNOME_SPELL, $GNOME_SPELL_MODULES)
AC_SUBST(GNOME_SPELL_CFLAGS)
AC_SUBST(GNOME_SPELL_LIBS)

ORBIT_IDL="`$PKG_CONFIG --variable=orbit_idl ORBit-2.0`"
AC_SUBST(ORBIT_IDL)

BONOBO_IDL_INCLUDES="-I`$PKG_CONFIG --variable=idldir libbonobo-2.0` -I`$PKG_CONFIG --variable=idldir bonobo-activation-2.0`"
AC_SUBST(BONOBO_IDL_INCLUDES)

GNOME_SPELL_DATADIR="${datadir}"
AC_SUBST(GNOME_SPELL_DATADIR)

dnl
dnl Final part
dnl

AC_OUTPUT([
Makefile
gnome-spell.spec
po/Makefile.in
gnome-spell/Makefile
art/Makefile
])
