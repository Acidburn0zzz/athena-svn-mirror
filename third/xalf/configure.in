dnl Process this file with autoconf to produce a configure script.
AC_INIT(src/xalf.c)

AM_INIT_AUTOMAKE(xalf, 0.4)

dnl Specify a header configuration file
AM_CONFIG_HEADER(config.h)

dnl Checks for programs.
AC_PROG_CC

dnl Initialize libtool
dnl AM_DISABLE_STATIC
AM_PROG_LIBTOOL

AM_SANITY_CHECK

AC_PROG_INSTALL
AC_PROG_LN_S
AC_PROG_MAKE_SET
AC_ISC_POSIX

dnl Checks for libraries.
AM_PATH_GTK(1.2.0)

AC_CHECK_FUNCS([unsetenv])

dnl Check for getopt_long, substitute the distributed versions if not
AC_CHECK_FUNC(getopt_long,,[LIBOBJS="$LIBOBJS getopt.o getopt1.o"])
AC_SUBST(LIBOBJS)

dnl Check if ld-linux is available, eg. LD_PRELOAD can handle multiple libraries. 
dnl A cleaner solution would be nice. 
AC_CHECK_FILE(/lib/ld-linux.so.1, [AC_DEFINE(MULTI_PRELOAD)])
AC_CHECK_FILE(/lib/ld-linux.so.2, [AC_DEFINE(MULTI_PRELOAD)])

dnl GNOME capplet
AC_ARG_ENABLE(capplet, [  --enable-capplet        build the GNOME capplet [default=yes]],[enable_capplet="$enableval"],[enable_capplet=yes]) 
if test "$enable_capplet" = "yes"; then                                         
  AC_MSG_CHECKING([for GNOME control center config])                            
  GNOME_CC_CFLAGS="`gnome-config --cflags capplet`"                             
  GNOME_CC_LIBS="`gnome-config --libs capplet`"                                 
  if test $? -ne 0; then                                                        
    AC_MSG_RESULT([no])                                                         
    AC_MSG_WARN([Can't run "gnome-config capplet", not building capplet])       
    enable_capplet=no
  else                                                                          
    AC_MSG_RESULT([yes])                                                        
    AC_SUBST(GNOME_CC_CFLAGS)                                                   
    AC_SUBST(GNOME_CC_LIBS)                                                     
  fi                                                                            
fi   
AM_CONDITIONAL(COMPILE_CAPPLET, test x$enable_capplet = xyes)

AC_DEFINE(DEFAULT_TIMEOUT, 20)

AC_OUTPUT(
Makefile
extras/Makefile
lib/Makefile
src/Makefile
capplet/Makefile
)

