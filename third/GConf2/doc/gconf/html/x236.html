<HTML
><HEAD
><TITLE
>The GConfValue Datatype</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.76b+
"><LINK
REL="HOME"
TITLE="GConf Manual"
HREF="index.html"><LINK
REL="UP"
TITLE="C Language Client Library"
HREF="c120.html"><LINK
REL="PREVIOUS"
TITLE="The GConfEngine object"
HREF="x184.html"><LINK
REL="NEXT"
TITLE="Reading/Writing Configuration Values"
HREF="x289.html"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
BGCOLOR="#000000"
CELLPADDING="1"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
><FONT
COLOR="#FFFFFF"
SIZE="5"
>GConf Manual</FONT
></TH
></TR
><TR
><TD
WIDTH="25%"
BGCOLOR="#C00000"
ALIGN="left"
><A
HREF="x184.html"
><FONT
COLOR="#FFFFFF"
SIZE="3"
><B
>&#60;&#60;&#60; Previous Page</B
></FONT
></A
></TD
><TD
WIDTH="25%"
BGCOLOR="#0000C0"
ALIGN="center"
><FONT
COLOR="#FFFFFF"
SIZE="3"
><B
><A
HREF="index.html"
><FONT
COLOR="#FFFFFF"
SIZE="3"
><B
>Home</B
></FONT
></A
></B
></FONT
></TD
><TD
WIDTH="25%"
BGCOLOR="#00C000"
ALIGN="center"
><FONT
COLOR="#FFFFFF"
SIZE="3"
><B
><A
HREF="c120.html"
><FONT
COLOR="#FFFFFF"
SIZE="3"
><B
>Up</B
></FONT
></A
></B
></FONT
></TD
><TD
WIDTH="25%"
BGCOLOR="#C00000"
ALIGN="right"
><A
HREF="x289.html"
><FONT
COLOR="#FFFFFF"
SIZE="3"
><B
>Next Page &#62;&#62;&#62;</B
></FONT
></A
></TD
></TR
></TABLE
></DIV
><BR
CLEAR="all"><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN236">The <SPAN
CLASS="STRUCTNAME"
>GConfValue</SPAN
> Datatype</H1
><P
>        The <SPAN
CLASS="STRUCTNAME"
>GConfValue</SPAN
> struct represents 
        a value that can be obtained from or stored in the
        configuration database. It is simply a type marker 
        and a union of several value types, with constructor,
        destructor, "setter" and "getter" functions. When possible 
        the GConf library allows you to deal with simple C types
        instead of a <SPAN
CLASS="STRUCTNAME"
>GConfValue</SPAN
>, but 
        sometimes there is simply no way to know the type of an 
        object in advance. The <TT
CLASS="FILENAME"
>libgnome/gnome-config.h</TT
>
        interface simply returns strings in this case, for the
        programmer to parse manually; this was phenomenally broken and
        GConf fixes it with <SPAN
CLASS="STRUCTNAME"
>GConfValue</SPAN
>.        
      </P
><BR
CLEAR="all"><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN244">Accessing <SPAN
CLASS="STRUCTNAME"
>GConfValue</SPAN
></H2
><P
>          To read a <SPAN
CLASS="STRUCTNAME"
>GConfValue</SPAN
>, you first 
          determine its type and then read the value using one 
          of its accessor macros. The following useless code should 
          demonstrate this:
          <TABLE
BORDER="0"
BGCOLOR="#D6E8FF"
WIDTH="100%"
CELLPADDING="6"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>            
void
print_value(GConfValue* value)
{    
  switch (value-&#62;type)
    {
    case GCONF_VALUE_STRING:
      printf("%s\n", gconf_value_get_string(value));
      break;
    case GCONF_VALUE_INT:
      printf("%d\n", gconf_value_get_int(value));
      break;
    case GCONF_VALUE_FLOAT:
      printf("%g\n", gconf_value_get_float(value));
      break;
    case GCONF_VALUE_BOOL:
      printf("%s", gconf_value_get_bool(value) ? "true" : "false");
      break;
    case GCONF_VALUE_SCHEMA:
      {
        GConfSchema* schema = gconf_value_get_schema(value);

        /* printing a schema would be complicated, you get the idea */
      }
      break;
    case GCONF_VALUE_LIST:
      {
        GSList* iter = gconf_value_get_list(value);

        while (iter != NULL)
          {
            GConfValue* element = iter-&#62;data;
            
            print_value(element);
            
            iter = g_slist_next(iter);
          }
      }
      break;
    case GCONF_VALUE_PAIR:
      print_value(gconf_value_get_car(value));
      print_value(gconf_value_get_cdr(value));
      break;
    case GCONF_VALUE_INVALID:
      /* This is used internally by GConf, you can also
         use it yourself to indicate errors and such. It
         won't be returned from GConf functions though. */
      printf("invalid value");
      break;
      
    default:
      g_assert_not_reached();
      break;
    }
}
          </PRE
></TD
></TR
></TABLE
>
        </P
><P
>          A special note about values of type <SPAN
CLASS="SYMBOL"
>GCONF_VALUE_LIST</SPAN
>:
          the list contains <SPAN
CLASS="STRUCTNAME"
>GConfValue</SPAN
> objects, and all
          objects in the list must have the same type. You can get the type of
          the list with the <TT
CLASS="FUNCTION"
>gconf_value_get_list_type()</TT
> macro.
        </P
></DIV
><BR
CLEAR="all"><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN254">Creating/destroying a <SPAN
CLASS="STRUCTNAME"
>GConfValue</SPAN
></H2
><P
>          Often you obtain a <SPAN
CLASS="STRUCTNAME"
>GConfValue</SPAN
> from 
          a GConf routine such as <TT
CLASS="FUNCTION"
>gconf_engine_get ()</TT
>,
          but you can also create them yourself with
          <TT
CLASS="FUNCTION"
>gconf_value_new()</TT
>.
          <TT
CLASS="FUNCTION"
>gconf_value_new()</TT
> takes a single
          argument, the type of the newly-created value. Value types
          can't be changed after creating the value.
          <DIV
CLASS="FUNCSYNOPSIS"
><A
NAME="AEN262"><P
></P
><TABLE
BORDER="0"
BGCOLOR="#D6E8FF"
WIDTH="100%"
CELLPADDING="6"
><TR
><TD
><PRE
CLASS="FUNCSYNOPSISINFO"
>#include &lt;gconf/gconf-value.h&gt;</PRE
></TD
></TR
></TABLE
><CODE
CLASS="FUNCDEF"
>GConfValue*
              gconf_value_new
            </CODE
>(GConfValueType type);<P
></P
></DIV
>
          Note that <TT
CLASS="FILENAME"
>gconf/gconf-value.h</TT
> is
          automatically included by <TT
CLASS="FILENAME"
>gconf/gconf.h</TT
>.          
        </P
><DIV
CLASS="WARNING"
><P
></P
><TABLE
CLASS="WARNING"
BORDER="1"
WIDTH="100%"
><TR
><TD
ALIGN="CENTER"
><B
>You must initialize your values</B
></TD
></TR
><TR
><TD
ALIGN="LEFT"
><P
>            Newly-constructed values are invalid; if you use the accessor macros
            before you set the contents of the value, the results are
            undefined. Use <TT
CLASS="FUNCTION"
>gconf_value_set_int()</TT
>,
            <TT
CLASS="FUNCTION"
>gconf_value_set_string()</TT
>, and so on to
            initialize the value.
          </P
></TD
></TR
></TABLE
></DIV
><P
>          You can destroy a <SPAN
CLASS="STRUCTNAME"
>GConfValue</SPAN
> with 
          <TT
CLASS="FUNCTION"
>gconf_value_free()</TT
>, and copy one
          with <TT
CLASS="FUNCTION"
>gconf_value_copy()</TT
>. The copy is a
          deep copy, that is, child values contained in lists or 
          pairs are also copied.
          <DIV
CLASS="FUNCSYNOPSIS"
><A
NAME="AEN279"><P
></P
><TABLE
BORDER="0"
BGCOLOR="#D6E8FF"
WIDTH="100%"
CELLPADDING="6"
><TR
><TD
><PRE
CLASS="FUNCSYNOPSISINFO"
>#include &lt;gconf/gconf-value.h&gt;</PRE
></TD
></TR
></TABLE
><CODE
CLASS="FUNCDEF"
>GConfValue*
              gconf_value_copy
            </CODE
>(GConfValue* src);<CODE
CLASS="FUNCDEF"
>void
              gconf_value_free
            </CODE
>GConfValue* value);<P
></P
></DIV
>
        </P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><BR
CLEAR="all"><BR><TABLE
WIDTH="100%"
BORDER="0"
BGCOLOR="#000000"
CELLPADDING="1"
CELLSPACING="0"
><TR
><TD
WIDTH="25%"
BGCOLOR="#C00000"
ALIGN="left"
><A
HREF="x184.html"
><FONT
COLOR="#FFFFFF"
SIZE="3"
><B
>&#60;&#60;&#60; Previous Page</B
></FONT
></A
></TD
><TD
WIDTH="25%"
BGCOLOR="#0000C0"
ALIGN="center"
><FONT
COLOR="#FFFFFF"
SIZE="3"
><B
><A
HREF="index.html"
><FONT
COLOR="#FFFFFF"
SIZE="3"
><B
>Home</B
></FONT
></A
></B
></FONT
></TD
><TD
WIDTH="25%"
BGCOLOR="#00C000"
ALIGN="center"
><FONT
COLOR="#FFFFFF"
SIZE="3"
><B
><A
HREF="c120.html"
><FONT
COLOR="#FFFFFF"
SIZE="3"
><B
>Up</B
></FONT
></A
></B
></FONT
></TD
><TD
WIDTH="25%"
BGCOLOR="#C00000"
ALIGN="right"
><A
HREF="x289.html"
><FONT
COLOR="#FFFFFF"
SIZE="3"
><B
>Next Page &#62;&#62;&#62;</B
></FONT
></A
></TD
></TR
><TR
><TD
COLSPAN="2"
ALIGN="left"
><FONT
COLOR="#FFFFFF"
SIZE="3"
><B
>The <SPAN
CLASS="STRUCTNAME"
>GConfEngine</SPAN
> object</B
></FONT
></TD
><TD
COLSPAN="2"
ALIGN="right"
><FONT
COLOR="#FFFFFF"
SIZE="3"
><B
>Reading/Writing Configuration Values</B
></FONT
></TD
></TR
></TABLE
></DIV
></BODY
></HTML
>