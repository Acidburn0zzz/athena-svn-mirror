/* 
 * Imakefile for the Athena Login library
 *
 * $Author: ghudson $
 * $Id: Imakefile,v 1.8 1997-10-13 22:44:51 ghudson Exp $
 *
 * Copyright 1994 by the Massachusetts Institute of Technology.
 * For copying and distribution information, see the file
 * "mit-copyright.h".
 */

SRC=etale.c etalw.c init.c setuser.c passwd.c modify.c group.c \
	start.c homedir.c utmp.c

OBJ=etale.o etalw.o init.o setuser.o passwd.o modify.o group.o \
	start.o homedir.o utmp.o


LIB=-lkrb4 -ldes425 -lkrb5 -lcrypto -lcom_err -lhesiod

INC=-I..

DEFINES=${INC} ${DEBUG}

AnsiCC()

error_table(etale)

error_table(etalw)

SimpleLibrary(AL,$(OBJ),$(ATHLIBDIR))
create_dir($(ATHINCDIR)/AL)
install_file(AL.h,$(ATHINCDIR)/AL)
install_file(etale.h,$(ATHINCDIR)/AL)
install_file(etalw.h,$(ATHINCDIR)/AL)
install_file(ptypes.h,$(ATHINCDIR)/AL)

build_program(testpw,testpw.o,,-L. -lAL ${LIB})
build_program(testgr,testgr.o,,-L. -lAL ${LIB})
build_program(testut,testut.o,,-L. -lAL ${LIB})
build_program(readutmp, readutmp.o,,)
build_program(readwtmp, readwtmp.o,,)

/**/# mkptypes is in the watchmaker locker
ptypes.h: $(SRC)
	$(RM) ptypes.h~
	-mv ptypes.h ptypes.h~
	mkptypes ${SRC} | sed "s/int NOARGS/void/g" > ptypes.h
